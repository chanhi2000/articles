import{_ as p}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c,b as n,t as i,e as a,n as e,g as t,f as l,r,o as u}from"./app-BgNevrm5.js";const d={},k={id:"frontmatter-title-á„€á…ªá†«á„…á…§á†«",tabindex:"-1"},m={class:"header-anchor",href:"#frontmatter-title-á„€á…ªá†«á„…á…§á†«"},h=n("nav",{class:"table-of-contents"},[n("ul")],-1),v=n("hr",null,null,-1),g=l(`<p>Part of the infuriating nature of Flappy Bird was that there were all sorts of collisions that could instantly kill you. In our game, these are massive rocks that will come out from the top and bottom of the screen â€“ and if a player hits any rock, or the ground, they are history.</p><p>The player&#39;s job is to fly their plane safely through the rocks that come along. The difficult part is that the gap between rocks varies in position, and can be high, low or in the middle of the screen, so the player needs quick reactions to score anything over a few points.</p><p>We&#39;re going to make a <code>createRocks()</code> method in just a moment, but first here&#39;s what it needs to do:</p><ol><li>Create top and bottom rock sprites. They are both the same graphic, but we&#39;re going to rotate the top one and flip it horizontally so that the two rocks form a spiky death for the player.</li><li>Create a third sprite that is a large red rectangle. This will be positioned just after the rocks and will be used to track when the player has passed through the rocks safely â€“ if they touch that red rectangle, they should score a point. (Don&#39;t worry, we&#39;ll make it invisible later!)</li><li>Use Swiftâ€™s random number generation to generate a number in a range. This will be used to determine where the safe gap in the rocks should be.</li><li>Position the rocks just off the right edge of the screen, then animate them across to the left edge. When they are safely off the left edge, remove them from the game.</li></ol><p>Here&#39;s the <code>createRocks()</code> method, with numbered comments matching the numbers above:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">createRocks</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// 1</span></span>
<span class="line">    <span class="token keyword">let</span> rockTexture <span class="token operator">=</span> <span class="token class-name">SKTexture</span><span class="token punctuation">(</span>imageNamed<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;rock&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">let</span> topRock <span class="token operator">=</span> <span class="token class-name">SKSpriteNode</span><span class="token punctuation">(</span>texture<span class="token punctuation">:</span> rockTexture<span class="token punctuation">)</span></span>
<span class="line">    topRock<span class="token punctuation">.</span>zRotation <span class="token operator">=</span> <span class="token punctuation">.</span>pi</span>
<span class="line">    topRock<span class="token punctuation">.</span>xScale <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1.0</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">let</span> bottomRock <span class="token operator">=</span> <span class="token class-name">SKSpriteNode</span><span class="token punctuation">(</span>texture<span class="token punctuation">:</span> rockTexture<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    topRock<span class="token punctuation">.</span>zPosition <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">20</span></span>
<span class="line">    bottomRock<span class="token punctuation">.</span>zPosition <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">20</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// 2</span></span>
<span class="line">    <span class="token keyword">let</span> rockCollision <span class="token operator">=</span> <span class="token class-name">SKSpriteNode</span><span class="token punctuation">(</span>color<span class="token punctuation">:</span> <span class="token class-name">UIColor</span><span class="token punctuation">.</span>red<span class="token punctuation">,</span> size<span class="token punctuation">:</span> <span class="token class-name">CGSize</span><span class="token punctuation">(</span>width<span class="token punctuation">:</span> <span class="token number">32</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> frame<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    rockCollision<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;scoreDetect&quot;</span></span></span>
<span class="line"></span>
<span class="line">    <span class="token function">addChild</span><span class="token punctuation">(</span>topRock<span class="token punctuation">)</span></span>
<span class="line">    <span class="token function">addChild</span><span class="token punctuation">(</span>bottomRock<span class="token punctuation">)</span></span>
<span class="line">    <span class="token function">addChild</span><span class="token punctuation">(</span>rockCollision<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// 3</span></span>
<span class="line">    <span class="token keyword">let</span> xPosition <span class="token operator">=</span> frame<span class="token punctuation">.</span>width <span class="token operator">+</span> topRock<span class="token punctuation">.</span>frame<span class="token punctuation">.</span>width</span>
<span class="line"></span>
<span class="line">    <span class="token keyword">let</span> max <span class="token operator">=</span> <span class="token class-name">CGFloat</span><span class="token punctuation">(</span>frame<span class="token punctuation">.</span>height <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">let</span> yPosition <span class="token operator">=</span> <span class="token class-name">CGFloat</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">50</span><span class="token operator">...</span>max<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// this next value affects the width of the gap between rocks</span></span>
<span class="line">    <span class="token comment">// make it smaller to make your game harder â€“ if you&#39;re feeling evil!</span></span>
<span class="line">    <span class="token keyword">let</span> rockDistance<span class="token punctuation">:</span> <span class="token class-name">CGFloat</span> <span class="token operator">=</span> <span class="token number">70</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// 4</span></span>
<span class="line">    topRock<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token class-name">CGPoint</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> xPosition<span class="token punctuation">,</span> y<span class="token punctuation">:</span> yPosition <span class="token operator">+</span> topRock<span class="token punctuation">.</span>size<span class="token punctuation">.</span>height <span class="token operator">+</span> rockDistance<span class="token punctuation">)</span></span>
<span class="line">    bottomRock<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token class-name">CGPoint</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> xPosition<span class="token punctuation">,</span> y<span class="token punctuation">:</span> yPosition <span class="token operator">-</span> rockDistance<span class="token punctuation">)</span></span>
<span class="line">    rockCollision<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token class-name">CGPoint</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> xPosition <span class="token operator">+</span> <span class="token punctuation">(</span>rockCollision<span class="token punctuation">.</span>size<span class="token punctuation">.</span>width <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> frame<span class="token punctuation">.</span>midY<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">let</span> endPosition <span class="token operator">=</span> frame<span class="token punctuation">.</span>width <span class="token operator">+</span> <span class="token punctuation">(</span>topRock<span class="token punctuation">.</span>frame<span class="token punctuation">.</span>width <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">let</span> moveAction <span class="token operator">=</span> <span class="token class-name">SKAction</span><span class="token punctuation">.</span><span class="token function">moveBy</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token operator">-</span>endPosition<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> duration<span class="token punctuation">:</span> <span class="token number">6.2</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">let</span> moveSequence <span class="token operator">=</span> <span class="token class-name">SKAction</span><span class="token punctuation">.</span><span class="token function">sequence</span><span class="token punctuation">(</span><span class="token punctuation">[</span>moveAction<span class="token punctuation">,</span> <span class="token class-name">SKAction</span><span class="token punctuation">.</span><span class="token function">removeFromParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">    topRock<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>moveSequence<span class="token punctuation">)</span></span>
<span class="line">    bottomRock<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>moveSequence<span class="token punctuation">)</span></span>
<span class="line">    rockCollision<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>moveSequence<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>If you haven&#39;t seen it before, the <code>xScale</code> property lets you stretch sprites horizontally. Using -1.0 as the value is what causes the flip effect - it stretches the sprite by -100%, inverting it. I&#39;m also using -20 for the <code>zPosition</code> because we want the rocks to appear behind the ground sprites to keep the illusion intact.</p><p>You&#39;ll notice we&#39;re adding the movement action to the top rock, the bottom rock and the collision sprite. If you wanted, you could create an extra <code>SKNode</code> that contains all three rock sections, then animate <em>that</em>, but it gives you the same result. You might also have noticed the curious duration I set: 6.2. I chose this through trial and error because the rocks move a different distance to the ground and yet need to move at about the same speed â€“ a duration of 6.2 comes close enough.</p><p>Now, we&#39;re <em>not</em> going to add a call to <code>createRocks()</code> in <code>didMove(to:)</code>. You see, if we did that it would create just one pair of rocks, which isn&#39;t what we want. Instead, we want rocks to be created every few seconds continuously until the player dies, which means we need a second method: <code>startRocks()</code>. Add this now:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">startRocks</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> create <span class="token operator">=</span> <span class="token class-name">SKAction</span><span class="token punctuation">.</span>run <span class="token punctuation">{</span> <span class="token punctuation">[</span><span class="token keyword">unowned</span> <span class="token keyword">self</span><span class="token punctuation">]</span> <span class="token keyword">in</span></span>
<span class="line">        <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">createRocks</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">let</span> wait <span class="token operator">=</span> <span class="token class-name">SKAction</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span>forDuration<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">let</span> sequence <span class="token operator">=</span> <span class="token class-name">SKAction</span><span class="token punctuation">.</span><span class="token function">sequence</span><span class="token punctuation">(</span><span class="token punctuation">[</span>create<span class="token punctuation">,</span> wait<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">let</span> repeatForever <span class="token operator">=</span> <span class="token class-name">SKAction</span><span class="token punctuation">.</span><span class="token function">repeatForever</span><span class="token punctuation">(</span>sequence<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token function">run</span><span class="token punctuation">(</span>repeatForever<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That new method calls <code>createRocks()</code>, waits three seconds, calls <code>createRocks()</code> again, waits again, and so on, forever. Add a call to <code>startRocks()</code> to your <code>didMove(to:)</code> method, and if you run the app you&#39;ll really start to see things looking good: rocks should appear at random heights, with the red scoring box straight after them. Yes, you can&#39;t crash into them yet, but we&#39;ll get there soon!</p><p>The last thing we&#39;re going to do in this chapter is add a score. As you should have completed the earlier game projects already, the only surprising thing here is that I&#39;m not going to use Chalkduster as my font â€“ and only then because it&#39;s not easy to read against moving rocks and mountains!</p><p>Add these two properties to your class. One is to hold the score as an integer, and the other is to draw the score to the screen using a <code>SKLabelNode</code>:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">var</span> scoreLabel<span class="token punctuation">:</span> <span class="token class-name">SKLabelNode</span><span class="token operator">!</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">var</span> score <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">didSet</span> <span class="token punctuation">{</span></span>
<span class="line">        scoreLabel<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;SCORE: </span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">score</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">&quot;</span></span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>As per usual, we use a property observer to update the label whenever the score changes. Now add this <code>createScore()</code> method to your class:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">createScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    scoreLabel <span class="token operator">=</span> <span class="token class-name">SKLabelNode</span><span class="token punctuation">(</span>fontNamed<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Optima-ExtraBlack&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    scoreLabel<span class="token punctuation">.</span>fontSize <span class="token operator">=</span> <span class="token number">24</span></span>
<span class="line"></span>
<span class="line">    scoreLabel<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token class-name">CGPoint</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> frame<span class="token punctuation">.</span>midX<span class="token punctuation">,</span> y<span class="token punctuation">:</span> frame<span class="token punctuation">.</span>maxY <span class="token operator">-</span> <span class="token number">60</span><span class="token punctuation">)</span></span>
<span class="line">    scoreLabel<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;SCORE: 0&quot;</span></span></span>
<span class="line">    scoreLabel<span class="token punctuation">.</span>fontColor <span class="token operator">=</span> <span class="token class-name">UIColor</span><span class="token punctuation">.</span>black</span>
<span class="line"></span>
<span class="line">    <span class="token function">addChild</span><span class="token punctuation">(</span>scoreLabel<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That positions the score in the top right of the screen, safely away from the player so as not to be too annoying.</p><p>Add a call to <code>createScore()</code> to <code>didMove(to:)</code> and you&#39;re done. Now all that&#39;s left is the important stuff: the game play!</p><figure><img src="https://hackingwithswift.com/img/books/hws/36-3@2x.png" alt="Adding a red rectangle just after each set of rocks gives us something our player can collide against, but make sure you hide it later!" tabindex="0" loading="lazy"><figcaption>Adding a red rectangle just after each set of rocks gives us something our player can collide against, but make sure you hide it later!</figcaption></figure>`,19);function b(o,f){const s=r("VPCard");return u(),c("div",null,[n("h1",k,[n("a",m,[n("span",null,i(o.$frontmatter.title)+" ê´€ë ¨",1)])]),a(s,e(t({title:"Hacking with iOS â€“ learn to code iPhone and iPad apps with free Swift tutorials",desc:"Learn Swift coding for iOS with these free tutorials â€“ learn Swift, iOS, and Xcode",link:"/hackingwithswift.com/read/README.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(174,10,10,0.2)"})),null,16),h,v,a(s,e(t({title:"Creating collisions | Hacking with iOS",desc:"Creating collisions",link:"https://hackingwithswift.com/read/36/4/creating-collisions",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(174,10,10,0.2)"})),null,16),g])}const S=p(d,[["render",b],["__file","04-creating-collisions.html.vue"]]),x=JSON.parse('{"path":"/hackingwithswift.com/read/36/04-creating-collisions.html","title":"Creating collisions","lang":"ko-KR","frontmatter":{"lang":"ko-KR","title":"Creating collisions","description":"Article(s) > Creating collisions","category":["Swift","iOS","Article(s)"],"tag":["blog","hackingwithswift.com","crashcourse","swift","xcode","appstore","ios"],"head":[[{"meta":null},{"property":"og:title","content":"Article(s) > Creating collisions"},{"property":"og:description","content":"Creating collisions"},{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/hackingwithswift.com/read/36/04-creating-collisions.html"}],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/hackingwithswift.com/read/36/04-creating-collisions.html"}],["meta",{"property":"og:site_name","content":"ðŸ“šBookshelf"}],["meta",{"property":"og:title","content":"Creating collisions"}],["meta",{"property":"og:description","content":"Article(s) > Creating collisions"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://hackingwithswift.com/img/books/hws/36-3@2x.png"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"property":"article:tag","content":"blog"}],["meta",{"property":"article:tag","content":"hackingwithswift.com"}],["meta",{"property":"article:tag","content":"crashcourse"}],["meta",{"property":"article:tag","content":"swift"}],["meta",{"property":"article:tag","content":"xcode"}],["meta",{"property":"article:tag","content":"appstore"}],["meta",{"property":"article:tag","content":"ios"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Creating collisions\\",\\"image\\":[\\"https://hackingwithswift.com/img/books/hws/36-3@2x.png\\"],\\"dateModified\\":null,\\"author\\":[]}"]],"isOriginal":false},"headers":[],"git":{"contributors":[{"name":"chanhi2000","email":"chanhi2000@gmail.com","commits":2}]},"readingTime":{"minutes":3.62,"words":1085},"filePathRelative":"hackingwithswift.com/read/36/04-creating-collisions.md","excerpt":"\\n"}');export{S as comp,x as data};
