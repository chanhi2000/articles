import{_ as r}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as u,b as n,t as d,e as a,n as e,g as o,d as s,a as k,f as p,r as c,o as m}from"./app-BgNevrm5.js";const h={},g={id:"frontmatter-title-á„€á…ªá†«á„…á…§á†«",tabindex:"-1"},w={class:"header-anchor",href:"#frontmatter-title-á„€á…ªá†«á„…á…§á†«"},f=n("nav",{class:"table-of-contents"},[n("ul")],-1),v=n("hr",null,null,-1),b=n("blockquote",null,[n("p",null,"Available from Swift 5.9")],-1),y={href:"https://github.com/apple/swift-evolution/blob/main/proposals/0382-expression-macros.md",target:"_blank",rel:"noopener noreferrer"},x=n("code",null,"apple/swift-evolution",-1),_={href:"https://github.com/apple/swift-evolution/blob/main/proposals/0389-attached-macros.md",target:"_blank",rel:"noopener noreferrer"},S=n("code",null,"apple/swift-evolution",-1),M={href:"https://github.com/apple/swift-evolution/blob/main/proposals/0397-freestanding-declaration-macros.md",target:"_blank",rel:"noopener noreferrer"},q=n("code",null,"apple/swift-evolution",-1),P=p(`<p>Macros in something like C++ are a way to pre-process your code â€“ to effectively perform text replacement on the code before itâ€™s seen by the main compiler, so that you can generate code you really donâ€™t want to write by hand.</p><p>Swiftâ€™s macros are similar, but significantly more powerful â€“ and thus also significantly more complex. They also allow us to dynamically manipulate our projectâ€™s Swift code before itâ€™s compiled, allowing us to inject extra functionality at compile time.</p><p>The key things to know are:</p><ul><li>They are type-safe rather than simple string replacements, so you need to tell your macro exactly what data it will work with.</li><li>They run as external programs during the build phase, and do not live in your main app target.</li><li>Macros are broken down into multiple smaller types, such as <code>ExpressionMacro</code> to generate a single expression, <code>AccessorMacro</code> to add getters and setters, and <code>ConformanceMacro</code> to make a type conform to a protocol.</li><li>Macros work with your parsed source code â€“ we can query individual parts of the code, such as the name of a property weâ€™re manipulating or it types, or the various properties inside a struct.</li><li>They work inside a sandbox and must operate only on the date they are given.</li></ul><p>That last part is particularly important: Swiftâ€™s macros support are built around Appleâ€™s SwiftSyntax library for understanding and manipulating source code. You must add this as a dependency for your macros.</p><p>Letâ€™s start with a simple macro, so you can see how they work. Because macros are run at compile time, we can make a tiny macro that returns the date and time our app was built â€“ a helpful thing to have in your debug diagnostics. This takes several steps, several of which should take place a separate module from your main target.</p><p>First we need to create the code that performs the macro expansion â€“ the thing that will turn <code>#buildDate</code> into something like <strong>2023-06-05T18:00:00Z</strong>:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">public</span> <span class="token keyword">struct</span> <span class="token class-name">BuildDateMacro</span><span class="token punctuation">:</span> <span class="token class-name">ExpressionMacro</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">func</span> <span class="token function-definition function">expansion</span><span class="token punctuation">(</span></span>
<span class="line">        of node<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">FreestandingMacroExpansionSyntax</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token keyword">in</span> context<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">MacroExpansionContext</span></span>
<span class="line">    <span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">ExprSyntax</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">let</span> date <span class="token operator">=</span> <span class="token class-name">ISO8601DateFormatter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span>from<span class="token punctuation">:</span> <span class="token punctuation">.</span>now<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string-literal"><span class="token string">&quot;\\&quot;</span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">raw<span class="token punctuation">:</span> date</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">\\&quot;&quot;</span></span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container important"><p class="hint-container-title">Important</p><p>This code should <em>not</em> be in your main app target; we donâ€™t want that code being compiled into our finished app, we just want the finished date string in there.</p></div><p>Inside that same module we create a struct that conforms to the <code>CompilerPlugin</code> protocol, exporting our macro:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token class-name">SwiftCompilerPlugin</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token class-name">SwiftSyntaxMacros</span></span>
<span class="line"></span>
<span class="line"><span class="token attribute atrule">@main</span></span>
<span class="line"><span class="token keyword">struct</span> <span class="token class-name">MyMacrosPlugin</span><span class="token punctuation">:</span> <span class="token class-name">CompilerPlugin</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> providingMacros<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">Macro</span><span class="token punctuation">.</span><span class="token keyword">Type</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">        <span class="token class-name">BuildDateMacro</span><span class="token punctuation">.</span><span class="token keyword">self</span></span>
<span class="line">    <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,11),C=n("code",null,"Package.swift",-1),T=p(`<div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token punctuation">.</span><span class="token function">macro</span><span class="token punctuation">(</span></span>
<span class="line">  name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;MyMacrosPlugin&quot;</span></span><span class="token punctuation">,</span></span>
<span class="line">  dependencies<span class="token punctuation">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">product</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;SwiftSyntax&quot;</span></span><span class="token punctuation">,</span> package<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;swift-syntax&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">product</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;SwiftSyntaxMacros&quot;</span></span><span class="token punctuation">,</span> package<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;swift-syntax&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">product</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;SwiftCompilerPlugin&quot;</span></span><span class="token punctuation">,</span> package<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;swift-syntax&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That finishes <em>creating</em> the macro in an external module. The rest of our code takes place wherever we want to <em>use</em> the macro, such as in our main app target.</p><p>This takes two steps, starting with a definition of what the macro is. In our case this is a free-standing expression macro that will return a string, it exists inside the <code>MyMacrosPlugin</code> module, and has the strict name <code>BuildDateMacro</code>. So, weâ€™d add this definition to our main target:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@freestanding</span><span class="token punctuation">(</span>expression<span class="token punctuation">)</span></span>
<span class="line">macro <span class="token function">buildDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">String</span> <span class="token operator">=</span></span>
<span class="line">  <span class="token other-directive property">#externalMacro</span><span class="token punctuation">(</span>module<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;MyMacrosPlugin&quot;</span></span><span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;BuildDateMacro&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>And the second step is to actually use the macro, like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token function">print</span><span class="token punctuation">(</span><span class="token other-directive property">#buildDate</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>When you read through this code, the most important thing to take away is that the main macro functionality â€“ all that code inside the <code>BuildDateMacro</code> struct â€“ is run at build time, with its results being injected back into the call sites. So, our little <code>print()</code> call above would be rewritten to something like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;2023-06-05T18:00:00Z&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>This in turn means the code inside your macros can be as complex as you need: we could have crafted our date in any way we wanted, because all that finished code actually sees is the string we returned.</p><p>Now, in practice the Swift team recommends <em>against</em> this kind of macro, because they want us to build things with consistent output â€“ they prefer macros that produce the same output given the same output, because it allows things like incremental builds to function efficiently.</p><p>Letâ€™s try a slightly more useful macro, this time making a <em>member attribute</em> macro. When applied to a type such as a class, this lets us apply an attribute to every member in a class. This is identical in concept to the older <code>@objcMembers</code> attribute, which adds <code>@objc</code> to each of the properties in a type.</p><p>For example, if you have an observable object that uses <code>@Published</code> on every one of its properties, you could write a simple <code>@AllPublished</code> macro that does the job for you. First, write the macro itself:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">public</span> <span class="token keyword">struct</span> <span class="token class-name">AllPublishedMacro</span><span class="token punctuation">:</span> <span class="token class-name">MemberAttributeMacro</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">func</span> <span class="token function-definition function">expansion</span><span class="token punctuation">(</span></span>
<span class="line">        of node<span class="token punctuation">:</span> <span class="token class-name">AttributeSyntax</span><span class="token punctuation">,</span></span>
<span class="line">        attachedTo declaration<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">DeclGroupSyntax</span><span class="token punctuation">,</span></span>
<span class="line">        providingAttributesFor member<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">DeclSyntaxProtocol</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token keyword">in</span> context<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">MacroExpansionContext</span></span>
<span class="line">    <span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token operator">-&gt;</span> <span class="token punctuation">[</span><span class="token class-name">AttributeSyntax</span><span class="token punctuation">]</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token class-name">AttributeSyntax</span><span class="token punctuation">(</span>attributeName<span class="token punctuation">:</span> <span class="token class-name">SimpleTypeIdentifierSyntax</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">identifier</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Published&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Second, include that in your list of provided macros:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">struct</span> <span class="token class-name">MyMacrosPlugin</span><span class="token punctuation">:</span> <span class="token class-name">CompilerPlugin</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> providingMacros<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">Macro</span><span class="token punctuation">.</span><span class="token keyword">Type</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">        <span class="token class-name">BuildDateMacro</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token class-name">AllPublishedMacro</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Third, declare the macro in your main app target, this time marking it as an attached member-attribute macro:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@attached</span><span class="token punctuation">(</span>memberAttribute<span class="token punctuation">)</span></span>
<span class="line">macro <span class="token class-name">AllPublished</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token other-directive property">#externalMacro</span><span class="token punctuation">(</span>module<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;MyMacrosPlugin&quot;</span></span><span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;AllPublishedMacro&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>And now use it to annotate your observable object class:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@AllPublished</span> <span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">:</span> <span class="token class-name">ObservableObject</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">var</span> username <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;Taylor&quot;</span></span></span>
<span class="line">    <span class="token keyword">var</span> age <span class="token operator">=</span> <span class="token number">26</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,19),A={href:"https://github.com/DougGregor/swift-macro-examples",target:"_blank",rel:"noopener noreferrer"},j=n("code",null,"DougGregor/swift-macro-examples",-1),D=p(`<p>Declaring the macro in our app target is straightforward, including adding a string parameter:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@freestanding</span><span class="token punctuation">(</span>expression<span class="token punctuation">)</span> <span class="token keyword">public</span> macro <span class="token function">URL</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> stringLiteral<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token constant">URL</span> <span class="token operator">=</span> <span class="token other-directive property">#externalMacro</span><span class="token punctuation">(</span>module<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;MyMacrosPlugin&quot;</span></span><span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;URLMacro&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Using it is also straightforward:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token other-directive property">#URL</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;https://swift.org&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"><span class="token function">print</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span>absoluteString<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>That makes <code>url</code> into a full <code>URL</code> instance rather than an optional one, because we will have checked the URL is correct at compile time.</p>`,5),E={href:"https://swift.org",target:"_blank",rel:"noopener noreferrer"},R=p(`<div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">public</span> <span class="token keyword">struct</span> <span class="token class-name">URLMacro</span><span class="token punctuation">:</span> <span class="token class-name">ExpressionMacro</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">func</span> <span class="token function-definition function">expansion</span><span class="token punctuation">(</span></span>
<span class="line">        of node<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">FreestandingMacroExpansionSyntax</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token keyword">in</span> context<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">MacroExpansionContext</span></span>
<span class="line">    <span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">ExprSyntax</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">guard</span> <span class="token keyword">let</span> argument <span class="token operator">=</span> node<span class="token punctuation">.</span>argumentList<span class="token punctuation">.</span>first<span class="token operator">?</span><span class="token punctuation">.</span>expression<span class="token punctuation">,</span></span>
<span class="line">              <span class="token keyword">let</span> segments <span class="token operator">=</span> argument<span class="token punctuation">.</span><span class="token keyword">as</span><span class="token punctuation">(</span><span class="token class-name">StringLiteralExprSyntax</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span>segments</span>
<span class="line">        <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token function">fatalError</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;#URL requires a static string literal&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">guard</span> <span class="token keyword">let</span> <span class="token omit keyword">_</span> <span class="token operator">=</span> <span class="token function">URL</span><span class="token punctuation">(</span>string<span class="token punctuation">:</span> segments<span class="token punctuation">.</span>description<span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token function">fatalError</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Malformed url: </span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">argument</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string-literal"><span class="token string">&quot;URL(string: </span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">argument</span><span class="token interpolation-punctuation punctuation">)</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">!&quot;</span></span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>SwiftSyntax is marvelous, but itâ€™s not what Iâ€™d call <em>discoverable</em>.</p><p>There are three more things I want to add before moving on.</p><p>First, the <code>MacroExpansionContext</code> value weâ€™re given has a very helpful <code>makeUniqueName()</code> method, which will produce a new variable name thatâ€™s guaranteed not to conflict with any other names in the current context. If youâ€™re looking to inject new names into the finished code, <code>makeUniqueName()</code> is a smart move.</p>`,4),L={href:"https://github.com/apple/swift/pull/62425",target:"_blank",rel:"noopener noreferrer"},U=n("code",null,"apple/swift",-1),I=n("p",null,"And finally, the extensive transformations that macros enable may mean that Swift Evolution itself will evolve over the next year or two, because so many features that might previously have required extensive compiler support and discussion can now be prototyped and perhaps even shipped using macros.",-1),N={class:"hint-container details"},B=n("summary",null,"Other Changes in Swift 5.9",-1),F={href:"https://hackingwithswift.com/files/playgrounds/swift/playground-5-8-to-5-9.playground.zip",target:"_blank",rel:"noopener noreferrer"};function V(l,O){const t=c("VPCard"),i=c("FontIcon");return m(),u("div",null,[n("h1",g,[n("a",w,[n("span",null,d(l.$frontmatter.title)+" ê´€ë ¨",1)])]),a(t,e(o({title:"HACKING WITH SWIFT",desc:"What's new in Swift?",link:"/hackingwithswift.com/swift/README.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),f,v,a(t,e(o({title:"Macros | Changes in Swift 5.9",desc:"Macros",link:"https://hackingwithswift.com/swift/5.9/macros",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),b,n("p",null,[n("a",y,[s("SE-0382 ("),a(i,{icon:"iconfont icon-github"}),x,s(")")]),s(", "),n("a",_,[s("SE-0389 ("),a(i,{icon:"iconfont icon-github"}),S,s(")")]),s(", and "),n("a",M,[s("SE-0397 ("),a(i,{icon:"iconfont icon-github"}),q,s(")")]),s(" combine to add macros to Swift, which allow us to create code that transforms syntax at compile time.")]),P,n("p",null,[s("We would then add that to our list of targets in "),a(i,{icon:"fa-brands fa-swift"}),C,s(":")]),T,n("p",null,[s("Our macros are able to accept parameters to control their behavior, although here itâ€™s easy for the complexity to really shoot upwards. As an example, Doug Gregor from the Swift team maintains "),n("a",A,[s("a small GitHub repository of example macros ("),a(i,{icon:"iconfont icon-github"}),j,s(")")]),s(", including one neat one that checks hard-coded URLs are valid at build time â€“ it becomes impossible to type a URL wrongly, because the build wonâ€™t proceed.")]),D,n("p",null,[s('Whatâ€™s harder is the actual macro itself, which needs to read the "'),n("a",E,[a(i,{icon:"fa-brands fa-swift"}),s("https://swift.org")]),s('" string that was passed in and convert it into a URL. Dougâ€™s version is more thorough, but if we boil it down to the bare minimum we get this:')]),R,n("p",null,[s("Second, one of the concerns with macros is the ability to debug your code when you hit a problem â€“ itâ€™s hard to trace whatâ€™s going on when you canâ€™t actually step through code easily. "),n("a",L,[s("Some work has already taken place inside SourceKit ("),a(i,{icon:"iconfont icon-github"}),U,s(")")]),s(" to expand macros as a refactoring operation, but really we need to see what ships in Xcode.")]),I,n("details",N,[B,a(t,e(o({title:"if and switch expressions | Changes in Swift 5.9",desc:"if and switch expressions",link:"/hackingwithswift.com/swift/5.9/if-switch-expressions.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),a(t,e(o({title:"Value and Type Parameter Packs | Changes in Swift 5.9",desc:"Value and Type Parameter Packs",link:"/hackingwithswift.com/swift/5.9/variadic-generics.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),k(` 
\`\`\`component VPCard
{
  "title": "Macros | Changes in Swift 5.9",
  "desc": "Macros",
  "link": "/hackingwithswift.com/swift/5.9/macros.md",
  "logo": "https://hackingwithswift.com/favicon.svg",
  "background": "rgba(54,94,226,0.2)"
}
\`\`\`
`),a(t,e(o({title:"Noncopyable structs and enums | Changes in Swift 5.9",desc:"Noncopyable structs and enums",link:"/hackingwithswift.com/swift/5.9/noncopyable-structs-and-enums.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),a(t,e(o({title:"consume operator to end the lifetime of a variable binding | Changes in Swift 5.9",desc:"consume operator to end the lifetime of a variable binding",link:"/hackingwithswift.com/swift/5.9/consume-operator.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),a(t,e(o({title:"Convenience Async[Throwing]Stream.makeStream methods | Changes in Swift 5.9",desc:"Convenience Async[Throwing]Stream.makeStream methods",link:"/hackingwithswift.com/swift/5.9/convenience-asyncthrowingstream-makestream.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),a(t,e(o({title:"Add sleep(for:) to Clock | Changes in Swift 5.9",desc:"Add sleep(for:) to Clock",link:"/hackingwithswift.com/swift/5.9/sleep-for-clock.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),a(t,e(o({title:"Discarding task groups | Changes in Swift 5.9",desc:"Discarding task groups",link:"/hackingwithswift.com/swift/5.9/discarding-task-groups.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),n("p",null,[n("a",F,[a(i,{icon:"fas fa-file-zipper"}),s("Download Swift 5.9 playground")])])])])}const K=r(h,[["render",V],["__file","macros.html.vue"]]),z=JSON.parse('{"path":"/hackingwithswift.com/swift/5.9/macros.html","title":"Macros","lang":"ko-KR","frontmatter":{"lang":"ko-KR","title":"Macros","description":"Article(s) > Macros","category":["Swift","Article(s)"],"tag":["blog","hackingwithswift.com","swift","swift-5.9"],"head":[[{"meta":null},{"property":"og:title","content":"Article(s) > Macros"},{"property":"og:description","content":"Macros"},{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/hackingwithswift.com/swift/5.9/macros.html"}],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/hackingwithswift.com/swift/5.9/macros.html"}],["meta",{"property":"og:site_name","content":"ðŸ“šBookshelf"}],["meta",{"property":"og:title","content":"Macros"}],["meta",{"property":"og:description","content":"Article(s) > Macros"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"property":"article:tag","content":"blog"}],["meta",{"property":"article:tag","content":"hackingwithswift.com"}],["meta",{"property":"article:tag","content":"swift"}],["meta",{"property":"article:tag","content":"swift-5.9"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Macros\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[]}"]],"isOriginal":false},"headers":[],"git":{"contributors":[{"name":"chanhi2000","email":"chanhi2000@gmail.com","commits":2}]},"readingTime":{"minutes":5.92,"words":1775},"filePathRelative":"hackingwithswift.com/swift/5.9/macros.md","excerpt":"\\n"}');export{K as comp,z as data};
