import{_ as r}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as d,b as n,t as u,e as a,n as i,g as o,d as s,f as h,r as t,o as m}from"./app-BgNevrm5.js";const g={},k={id:"frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´",tabindex:"-1"},w={class:"header-anchor",href:"#frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´"},v=n("nav",{class:"table-of-contents"},[n("ul")],-1),f=n("hr",null,null,-1),y=n("blockquote",null,[n("p",null,"Updated for Xcode 15")],-1),b=n("p",null,"So far we‚Äôve had a simple data model containing a collection of destinations. To finish the app we‚Äôre going to upgrade this so that each destination has a list of sights that users want to visit there, for example they might say when they visit Rome they want to see the colosseum, the forum, the Vatican, and so on.",-1),S=n("p",null,[s("In SwiftData this is called a "),n("em",null,"relationship"),s(": each destination has many sights to see. Rather than trying to cram all the sights into a single "),n("code",null,"Destination"),s(" object, we can instead create a separate "),n("code",null,"Sight"),s(" model, then tell SwiftData that our original "),n("code",null,"Destination"),s(" model has an array of sights ‚Äì it will take care of linking the two for us.")],-1),_=n("code",null,"Sight.swift",-1),x=h(`<div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@Model</span></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">Sight</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">var</span> name<span class="token punctuation">:</span> <span class="token class-name">String</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">init</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">self</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That stores only a single piece of data, which is the name of the sight ‚Äì later on you&#39;re welcome to add more to it, such as perhaps tracking whether the user has visited it already.</p><p>Now we can return to the <code>Destination</code> model and add a new property there:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">var</span> sights <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">Sight</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Just adding that property that is enough to tell SwiftData that each destination has many sights associated with it. Our original model didn&#39;t have that relationship, but that&#39;s okay: the next time you run the app, SwiftData will silently upgrade its data store to take this change into account with no extra work from us. This is called a <em>migration</em>, and it allows us to upgrade and adjust our models over time.</p><p>Of course, we need to actually add a way for users to list sights for each destination, and the simplest approach is to show a separate section in our view with a text field for new sight names.</p><p>First, add this new property to <code>EditDestinationView</code>:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> newSightName <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;&quot;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>That will track whatever the user is typing for their new sight name.</p><p>Second, add a new method that converts <code>newSightName</code> into an actual <code>Sight</code> object, then adds it to our destination&#39;s existing list of sights:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">addSight</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">guard</span> newSightName<span class="token punctuation">.</span>isEmpty <span class="token operator">==</span> <span class="token boolean">false</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    withAnimation <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">let</span> sight <span class="token operator">=</span> <span class="token class-name">Sight</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> newSightName<span class="token punctuation">)</span></span>
<span class="line">        destination<span class="token punctuation">.</span>sights<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>sight<span class="token punctuation">)</span></span>
<span class="line">        newSightName <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;&quot;</span></span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>And now we can add a new section to the form, looping over all the existing sights and also adding space to create new sights below:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">Section</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Sights&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">ForEach</span><span class="token punctuation">(</span>destination<span class="token punctuation">.</span>sights<span class="token punctuation">)</span> <span class="token punctuation">{</span> sight <span class="token keyword">in</span></span>
<span class="line">        <span class="token class-name">Text</span><span class="token punctuation">(</span>sight<span class="token punctuation">.</span>name<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token class-name">HStack</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">TextField</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Add a new sight in </span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">destination<span class="token punctuation">.</span>name</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">&quot;</span></span><span class="token punctuation">,</span> text<span class="token punctuation">:</span> $newSightName<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Add&quot;</span></span><span class="token punctuation">,</span> action<span class="token punctuation">:</span> addSight<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Notice how we can just access <code>destination.sights</code> directly? Relationships are loaded <em>lazily</em> by SwiftData, which means it will only load the sights for a destination only when they are actually used. This means <code>DestinationListingView</code> loads only the data it really needs, helping make sure our code remains fast and light on memory.</p><p>Now, before we&#39;re done with this relationship there&#39;s one tiny change I want to make. You see, right now we have a small problem: if our user decides they don&#39;t want to go to a destination they added, what should happen to all the sights they added to that destination?</p><p>SwiftData likes playing it safe by default, so in this situation deleting the destination will leave its sights intact and just hidden from view. Sometimes that&#39;s exactly what you&#39;ll want, but here it will just lead to clutter because there&#39;s no way of searching for sights that aren&#39;t attached to destinations.</p><p>This is when we need to give SwiftData a little extra guidance: we‚Äôre going to tell it that when we delete a destination it should also delete all the sights belonging to that destination.</p><p>To do that, we need to attach the <code>@Relationship</code> macro to the <code>sights</code> property, like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@Relationship</span><span class="token punctuation">(</span>deleteRule<span class="token punctuation">:</span> <span class="token punctuation">.</span>cascade<span class="token punctuation">)</span> <span class="token keyword">var</span> sights <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">Sight</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>A <em>cascade</em> delete rule means &quot;when we delete this object, delete all its sights too&quot; ‚Äì exactly what we want.</p>`,20);function D(l,T){const e=t("VPCard"),p=t("VidStack"),c=t("FontIcon");return m(),d("div",null,[n("h1",k,[n("a",w,[n("span",null,u(l.$frontmatter.title)+" Í¥ÄÎ†®",1)])]),a(e,i(o({title:"SwiftData by Example",desc:"Back to Home",link:"/hackingwithswift.com/swiftdata/README.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(174,10,10,0.2)"})),null,16),v,f,a(e,i(o({title:"Working with relationships | SwiftData by Example",desc:"Working with relationships",link:"https://hackingwithswift.com/quick-start/swiftdata/working-with-relationships",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),y,a(p,{src:"youtube/m1H7Q7EM_6Y"}),b,S,n("p",null,[s("To get started, create another new Swift file called "),a(c,{icon:"fa-brands fa-swift"}),_,s(", give it an import for SwiftData, then add this code there:")]),x])}const N=r(g,[["render",D],["__file","working-with-relationships.html.vue"]]),R=JSON.parse('{"path":"/hackingwithswift.com/swiftdata/working-with-relationships.html","title":"Working with relationships","lang":"ko-KR","frontmatter":{"lang":"ko-KR","title":"Working with relationships","description":"Article(s) > Working with relationships","category":["Swift","Article(s)"],"tag":["blog","hackingwithswift.com","crashcourse","swift","swiftdata","xcode","appstore"],"head":[[{"meta":null},{"property":"og:title","content":"Article(s) > Working with relationships"},{"property":"og:description","content":"Working with relationships"},{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/hackingwithswift.com/swiftdata/working-with-relationships.html"}],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/hackingwithswift.com/swiftdata/working-with-relationships.html"}],["meta",{"property":"og:site_name","content":"üìöBookshelf"}],["meta",{"property":"og:title","content":"Working with relationships"}],["meta",{"property":"og:description","content":"Article(s) > Working with relationships"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"property":"article:tag","content":"blog"}],["meta",{"property":"article:tag","content":"hackingwithswift.com"}],["meta",{"property":"article:tag","content":"crashcourse"}],["meta",{"property":"article:tag","content":"swift"}],["meta",{"property":"article:tag","content":"swiftdata"}],["meta",{"property":"article:tag","content":"xcode"}],["meta",{"property":"article:tag","content":"appstore"}],["meta",{"property":"article:published_time","content":"2023-09-30T00:00:00.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Working with relationships\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-09-30T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[]}"]],"date":"2023-09-30T00:00:00.000Z","isOriginal":false},"headers":[],"git":{"contributors":[{"name":"chanhi2000","email":"chanhi2000@gmail.com","commits":2}]},"readingTime":{"minutes":2.64,"words":793},"filePathRelative":"hackingwithswift.com/swiftdata/working-with-relationships.md","localizedDate":"2023ÎÖÑ 9Ïõî 30Ïùº","excerpt":"\\n"}');export{N as comp,R as data};
