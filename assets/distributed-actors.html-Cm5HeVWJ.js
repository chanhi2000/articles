import{_ as r}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as p,b as t,t as d,e as n,n as e,g as i,d as s,a as u,f as h,r as c,o as f}from"./app-BgNevrm5.js";const m={},g={id:"frontmatter-title-á„€á…ªá†«á„…á…§á†«",tabindex:"-1"},k={class:"header-anchor",href:"#frontmatter-title-á„€á…ªá†«á„…á…§á†«"},w=t("nav",{class:"table-of-contents"},[t("ul")],-1),b=t("hr",null,null,-1),v=t("blockquote",null,[t("p",null,"Available from Swift 5.7")],-1),y={href:"https://github.com/apple/swift-evolution/blob/main/proposals/0336-distributed-actor-isolation.md",target:"_blank",rel:"noopener noreferrer"},_=t("code",null,"apple/swift-evolution",-1),S={href:"https://github.com/apple/swift-evolution/blob/main/proposals/0344-distributed-actor-runtime.md",target:"_blank",rel:"noopener noreferrer"},C=t("code",null,"apple/swift-evolution",-1),x=t("p",null,"This is every part as complicated a problem as you might imagine, but there are three things to make it easier:",-1),D=t("li",null,[s("Swiftâ€™s approach of "),t("em",null,"location transparency"),s(" effectively forces us to assume the actors are remote, and in fact provides no way of determining at compile time whether an actor is local or remote â€“ we just use the same "),t("code",null,"await"),s(" calls we would no matter what, and if the actor happens to be local then the call is handled as a regular local actor function.")],-1),A={href:"https://github.com/apple/swift-distributed-actors",target:"_blank",rel:"noopener noreferrer"},q=t("code",null,"apple/swift-distributed-actors",-1),I={href:"https://swift.org/blog/distributed-actors/",target:"_blank",rel:"noopener noreferrer"},P=t("li",null,[s("To move from an actor to a distributed actor we mostly just need to write "),t("code",null,"distributed actor"),s(" then "),t("code",null,"distributed func"),s(" as needed.")],-1),R=h(`<p>So, we can write code like this to simulate someone tracking a trading card system:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token comment">// use Apple&#39;s ClusterSystem transport </span></span>
<span class="line"><span class="token keyword">typealias</span> <span class="token class-name">DefaultDistributedActorSystem</span> <span class="token operator">=</span> <span class="token class-name">ClusterSystem</span></span>
<span class="line"></span>
<span class="line">distributed <span class="token keyword">actor</span> <span class="token class-name">CardCollector</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">var</span> deck<span class="token punctuation">:</span> <span class="token class-name">Set</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">init</span><span class="token punctuation">(</span>deck<span class="token punctuation">:</span> <span class="token class-name">Set</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">self</span><span class="token punctuation">.</span>deck <span class="token operator">=</span> deck</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    distributed <span class="token keyword">func</span> <span class="token function-definition function">send</span><span class="token punctuation">(</span>card selected<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> to person<span class="token punctuation">:</span> <span class="token class-name">CardCollector</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token operator">-&gt;</span> <span class="token class-name">Bool</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">guard</span> deck<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>selected<span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">false</span> <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">do</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">try</span> <span class="token keyword">await</span> person<span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span>card<span class="token punctuation">:</span> selected<span class="token punctuation">)</span></span>
<span class="line">            deck<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>selected<span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword">return</span> <span class="token boolean">true</span></span>
<span class="line">        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">return</span> <span class="token boolean">false</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    distributed <span class="token keyword">func</span> <span class="token function-definition function">transfer</span><span class="token punctuation">(</span>card<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        deck<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>card<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Because of the throwing nature of distributed actor calls, we can be sure itâ€™s safe to remove the card from one collector if the call to <code>person.transfer(card:)</code> didnâ€™t throw.</p><p>Swiftâ€™s goal is that you can transfer your knowledge of actors over to distributed actors very easily, but there are some important differences that might catch you out.</p><p>First, all distributed functions must be called using <code>try</code> as well as <code>await</code> even if the function isnâ€™t marked as throwing, because itâ€™s possible for a failure to happen as a result of the network call going awry.</p><p>Second, all parameters and return values for distributed methods must conform to a serialization process of your choosing, such as <code>Codable</code>. This gets checked at compile time, so Swift can guarantee itâ€™s able to send and receive data from remote actors.</p><p>And third, you should consider adjusting your actor API to minimize data requests. For example, if you want to read the <code>username</code>, <code>firstName</code>, and <code>lastName</code> properties of a distributed actor, you should prefer to request all three with a single method call rather than requesting them as individual properties to avoid potentially having to go back and forward over the network several times.</p>`,7),N={class:"hint-container details"},T=t("summary",null,"Other Changes in Swift 5.7",-1),B={href:"https://hackingwithswift.com/files/playgrounds/swift/playground-5-6-to-5-7.playground.zip",target:"_blank",rel:"noopener noreferrer"};function V(l,j){const a=c("VPCard"),o=c("FontIcon");return f(),p("div",null,[t("h1",g,[t("a",k,[t("span",null,d(l.$frontmatter.title)+" ê´€ë ¨",1)])]),n(a,e(i({title:"HACKING WITH SWIFT",desc:"What's new in Swift?",link:"/hackingwithswift.com/swift/README.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),w,b,n(a,e(i({title:"Distributed actor isolation | Changes in Swift 5.7",desc:"Distributed actor isolation",link:"https://hackingwithswift.com/swift/5.7/distributed-actors",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),v,t("p",null,[t("a",y,[s("SE-0336 ("),n(o,{icon:"iconfont icon-github"}),_,s(")")]),s(" and "),t("a",S,[s("SE-0344 ("),n(o,{icon:"iconfont icon-github"}),C,s(")")]),s(" introduce the ability for actors to work in a distributed form â€“ to read and write properties or call methods over a network using remote procedure calls (RPC).")]),x,t("ol",null,[D,t("li",null,[s("Rather than forcing us to build our own actor transport systems, Apple is providing a "),t("a",A,[s("ready-made implementation ("),n(o,{icon:"iconfont icon-github"}),q,s(")")]),s(" for us to use. Apple has "),t("a",I,[n(o,{icon:"fa-brands fa-swift"}),s("said")]),s(" they â€œonly expect a handful of mature implementations to take the stage eventually,â€ but helpfully all the distributed actor features in Swift are agnostic of whatever actor transport you use.")]),P]),R,t("details",N,[T,n(a,e(i({title:"if let shorthand for unwrapping optionals | Changes in Swift 5.7",desc:"if let shorthand for unwrapping optionals",link:"/hackingwithswift.com/swift/5.7/if-let-shorthand.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),n(a,e(i({title:"Multi-statement closure type inference | Changes in Swift 5.7",desc:"Multi-statement closure type inference",link:"/hackingwithswift.com/swift/5.7/multi-statement-inference.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),n(a,e(i({title:"Clock, Instant, and Duration | Changes in Swift 5.7",desc:"Clock, Instant, and Duration",link:"/hackingwithswift.com/swift/5.7/clock.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),n(a,e(i({title:"Regular expressions | Changes in Swift 5.7",desc:"Regular expressions",link:"/hackingwithswift.com/swift/5.7/regexes.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),n(a,e(i({title:"Type inference from default expressions | Changes in Swift 5.7",desc:"Type inference from default expressions",link:"/hackingwithswift.com/swift/5.7/default-type-inference.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),n(a,e(i({title:"Concurrency in top-level code | Changes in Swift 5.7",desc:"Concurrency in top-level code",link:"/hackingwithswift.com/swift/5.7/top-level-concurrency.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),n(a,e(i({title:"Opaque parameter declarations | Changes in Swift 5.7",desc:"Opaque parameter declarations",link:"/hackingwithswift.com/swift/5.7/opaque-parameter-declarations.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),n(a,e(i({title:"Structural opaque result types | Changes in Swift 5.7",desc:"Structural opaque result types",link:"/hackingwithswift.com/swift/5.7/structural-opaque-result-types.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),n(a,e(i({title:"Unlock existentials for all protocols | Changes in Swift 5.7",desc:"Unlock existentials for all protocols",link:"/hackingwithswift.com/swift/5.7/unlock-existentials.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),n(a,e(i({title:"Lightweight same-type requirements for primary associated types | Changes in Swift 5.7",desc:"Lightweight same-type requirements for primary associated types",link:"/hackingwithswift.com/swift/5.7/primary-associated-types.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),n(a,e(i({title:"Constrained existential types | Changes in Swift 5.7",desc:"Constrained existential types",link:"/hackingwithswift.com/swift/5.7/constrained-existentials.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),u(` 
\`\`\`component VPCard
{
  "title": "Distributed actor isolation | Changes in Swift 5.7",
  "desc": "Distributed actor isolation",
  "link": "/hackingwithswift.com/swift/5.7/distributed-actors.md",
  "logo": "https://hackingwithswift.com/favicon.svg",
  "background": "rgba(54,94,226,0.2)"
}
\`\`\`
`),n(a,e(i({title:"buildPartialBlock for result builders | Changes in Swift 5.7",desc:"buildPartialBlock for result builders",link:"/hackingwithswift.com/swift/5.7/buildpartialblock.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),n(a,e(i({title:"Implicitly opened existentials | Changes in Swift 5.7",desc:"Implicitly opened existentials",link:"/hackingwithswift.com/swift/5.7/implicitly-opened-existentials.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),n(a,e(i({title:"Unavailable from async attribute | Changes in Swift 5.7",desc:"Unavailable from async attribute",link:"/hackingwithswift.com/swift/5.7/noasync.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),t("p",null,[t("a",B,[n(o,{icon:"fas fa-file-zipper"}),s("Download Swift 5.7 playground")])])])])}const F=r(m,[["render",V],["__file","distributed-actors.html.vue"]]),O=JSON.parse('{"path":"/hackingwithswift.com/swift/5.7/distributed-actors.html","title":"Distributed actor isolation","lang":"ko-KR","frontmatter":{"lang":"ko-KR","title":"Distributed actor isolation","description":"Article(s) > Distributed actor isolation","category":["Swift","Article(s)"],"tag":["blog","hackingwithswift.com","swift","swift-5.7"],"head":[[{"meta":null},{"property":"og:title","content":"Article(s) > Distributed actor isolation"},{"property":"og:description","content":"Distributed actor isolation"},{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/hackingwithswift.com/swift/5.7/distributed-actors.html"}],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/hackingwithswift.com/swift/5.7/distributed-actors.html"}],["meta",{"property":"og:site_name","content":"ðŸ“šBookshelf"}],["meta",{"property":"og:title","content":"Distributed actor isolation"}],["meta",{"property":"og:description","content":"Article(s) > Distributed actor isolation"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"property":"article:tag","content":"blog"}],["meta",{"property":"article:tag","content":"hackingwithswift.com"}],["meta",{"property":"article:tag","content":"swift"}],["meta",{"property":"article:tag","content":"swift-5.7"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Distributed actor isolation\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[]}"]],"isOriginal":false},"headers":[],"git":{"contributors":[{"name":"chanhi2000","email":"chanhi2000@gmail.com","commits":2}]},"readingTime":{"minutes":3.65,"words":1094},"filePathRelative":"hackingwithswift.com/swift/5.7/distributed-actors.md","excerpt":"\\n"}');export{F as comp,O as data};
