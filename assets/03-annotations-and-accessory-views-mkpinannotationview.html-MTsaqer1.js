import{_ as u}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as d,b as n,t as m,e as a,n as e,g as o,d as i,f as p,r as s,o as k}from"./app-BgNevrm5.js";const w={},h={id:"frontmatter-title-á„€á…ªá†«á„…á…§á†«",tabindex:"-1"},v={class:"header-anchor",href:"#frontmatter-title-á„€á…ªá†«á„…á…§á†«"},f=n("nav",{class:"table-of-contents"},[n("ul")],-1),y=n("hr",null,null,-1),g=p("<p>Every time the map needs to show an annotation, it calls a <code>viewFor</code> method on its delegate. We don&#39;t implement that method right now, so the default red pin is used with nothing special â€“ although as you&#39;ve seen it&#39;s smart enough to pull out the title for us.</p><p>Customizing an annotation view is a little bit like customizing a table view cell or collection view cell, because iOS automatically reuses annotation views to make best use of memory. If there isn&#39;t one available to reuse, we need to create one from scratch using the <code>MKPinAnnotationView</code> class.</p><p>Our custom annotation view is going to look a lot like the default view, with the exception that we&#39;re going to add a button that users can tap for more information. So, they tap the pin to see the city name, then tap its button to see more information. In our case, it&#39;s those fascinating facts I spent literally tens of seconds writing.</p><p>There are a couple of things you need to be careful of here. First, <code>viewFor</code> will be called for your annotations, but also Apple&#39;s. For example, if you enable tracking of the user&#39;s location then that&#39;s shown as an annotation and you don&#39;t want to try using it as a capital city. If an annotation is not one of yours, just return <code>nil</code> from the method to have Apple&#39;s default used instead.</p><p>Second, adding a button to the view isn&#39;t done using the <code>addTarget()</code> method you already saw in project 8. Instead, you just add the button and the map view will send a message to its delegate (us!) when it&#39;s tapped.</p><p>Here&#39;s a breakdown of what the method will do:</p><ol><li>If the annotation isn&#39;t from a capital city, it must return <code>nil</code> so iOS uses a default view.</li><li>Define a reuse identifier. This is a string that will be used to ensure we reuse annotation views as much as possible.</li><li>Try to dequeue an annotation view from the map view&#39;s pool of unused views.</li><li>If it isn&#39;t able to find a reusable view, create a new one using <code>MKPinAnnotationView</code> and sets its <code>canShowCallout</code> property to true. This triggers the popup with the city name.</li><li>Create a new <code>UIButton</code> using the built-in <code>.detailDisclosure</code> type. This is a small blue &quot;i&quot; symbol with a circle around it.</li><li>If it can reuse a view, update that view to use a different annotation.</li></ol>",7),b=n("code",null,"ViewController.swift",-1),A=p(`<div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">class</span> <span class="token class-name">ViewController</span><span class="token punctuation">:</span> <span class="token class-name">UIViewController</span> <span class="token punctuation">{</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>And change it to this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">class</span> <span class="token class-name">ViewController</span><span class="token punctuation">:</span> <span class="token class-name">UIViewController</span><span class="token punctuation">,</span> <span class="token class-name">MKMapViewDelegate</span> <span class="token punctuation">{</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Put this method into your view controller, watching out for my numbered comments:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">mapView</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> mapView<span class="token punctuation">:</span> <span class="token class-name">MKMapView</span><span class="token punctuation">,</span> viewFor annotation<span class="token punctuation">:</span> <span class="token class-name">MKAnnotation</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">MKAnnotationView</span><span class="token operator">?</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// 1</span></span>
<span class="line">    <span class="token keyword">guard</span> annotation <span class="token keyword">is</span> <span class="token class-name">Capital</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token nil constant">nil</span> <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// 2</span></span>
<span class="line">    <span class="token keyword">let</span> identifier <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;Capital&quot;</span></span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// 3</span></span>
<span class="line">    <span class="token keyword">var</span> annotationView <span class="token operator">=</span> mapView<span class="token punctuation">.</span><span class="token function">dequeueReusableAnnotationView</span><span class="token punctuation">(</span>withIdentifier<span class="token punctuation">:</span> identifier<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">if</span> annotationView <span class="token operator">==</span> <span class="token nil constant">nil</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">//4</span></span>
<span class="line">        annotationView <span class="token operator">=</span> <span class="token class-name">MKPinAnnotationView</span><span class="token punctuation">(</span>annotation<span class="token punctuation">:</span> annotation<span class="token punctuation">,</span> reuseIdentifier<span class="token punctuation">:</span> identifier<span class="token punctuation">)</span></span>
<span class="line">        annotationView<span class="token operator">?</span><span class="token punctuation">.</span>canShowCallout <span class="token operator">=</span> <span class="token boolean">true</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// 5</span></span>
<span class="line">        <span class="token keyword">let</span> btn <span class="token operator">=</span> <span class="token class-name">UIButton</span><span class="token punctuation">(</span>type<span class="token punctuation">:</span> <span class="token punctuation">.</span>detailDisclosure<span class="token punctuation">)</span></span>
<span class="line">        annotationView<span class="token operator">?</span><span class="token punctuation">.</span>rightCalloutAccessoryView <span class="token operator">=</span> btn</span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// 6</span></span>
<span class="line">        annotationView<span class="token operator">?</span><span class="token punctuation">.</span>annotation <span class="token operator">=</span> annotation</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> annotationView</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You can press <kbd>Cmd</kbd>+<kbd>R</kbd> to run your app, and now if you tap on any pin you&#39;ll see a city&#39;s name as well as a button you can tap to show more information. Like I said, you don&#39;t need to use <code>addTarget()</code> to add an action to the button, because you&#39;ll automatically be told by the map view using a <code>calloutAccessoryControlTapped</code> method.</p><p>When this method is called, you&#39;ll be told what map view sent it (we only have one, so that&#39;s easy enough), what annotation view the button came from (this is useful), as well as the button that was tapped.</p><p>The annotation view contains a property called <code>annotation</code>, which will contain our <code>Capital</code> object. So, we can pull that out, typecast it as a <code>Capital</code>, then show its title and information in any way we want. The easiest for now is just to use a <code>UIAlertController</code>, so that&#39;s what we&#39;ll do.</p><p>Add this code to your view controller, just beneath the previous method:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">mapView</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> mapView<span class="token punctuation">:</span> <span class="token class-name">MKMapView</span><span class="token punctuation">,</span> annotationView view<span class="token punctuation">:</span> <span class="token class-name">MKAnnotationView</span><span class="token punctuation">,</span> calloutAccessoryControlTapped control<span class="token punctuation">:</span> <span class="token class-name">UIControl</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">guard</span> <span class="token keyword">let</span> capital <span class="token operator">=</span> view<span class="token punctuation">.</span>annotation <span class="token keyword">as</span><span class="token operator">?</span> <span class="token class-name">Capital</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">let</span> placeName <span class="token operator">=</span> capital<span class="token punctuation">.</span>title</span>
<span class="line">    <span class="token keyword">let</span> placeInfo <span class="token operator">=</span> capital<span class="token punctuation">.</span>info</span>
<span class="line"></span>
<span class="line">    <span class="token keyword">let</span> ac <span class="token operator">=</span> <span class="token class-name">UIAlertController</span><span class="token punctuation">(</span>title<span class="token punctuation">:</span> placeName<span class="token punctuation">,</span> message<span class="token punctuation">:</span> placeInfo<span class="token punctuation">,</span> preferredStyle<span class="token punctuation">:</span> <span class="token punctuation">.</span>alert<span class="token punctuation">)</span></span>
<span class="line">    ac<span class="token punctuation">.</span><span class="token function">addAction</span><span class="token punctuation">(</span><span class="token class-name">UIAlertAction</span><span class="token punctuation">(</span>title<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;OK&quot;</span></span><span class="token punctuation">,</span> style<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token keyword">default</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token function">present</span><span class="token punctuation">(</span>ac<span class="token punctuation">,</span> animated<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>With that, the project is done. We have pins in place, city names being showed when the pins are tapped, and more information popping up when requested. Perfect!</p><p>!Now that we have customized the map pins, users can tap the &#39;i&#39; button to see some detail about each city.<a href="https://hackingwithswift.com/16-3img/books/hws/16-3@2x.png" target="_blank" rel="noopener noreferrer"></a></p>`,12);function V(c,_){const t=s("VPCard"),l=s("VidStack"),r=s("FontIcon");return k(),d("div",null,[n("h1",h,[n("a",v,[n("span",null,m(c.$frontmatter.title)+" ê´€ë ¨",1)])]),a(t,e(o({title:"Hacking with iOS â€“ learn to code iPhone and iPad apps with free Swift tutorials",desc:"Learn Swift coding for iOS with these free tutorials â€“ learn Swift, iOS, and Xcode",link:"/hackingwithswift.com/read/README.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(174,10,10,0.2)"})),null,16),f,y,a(t,e(o({title:"Annotations and accessory views: MKPinAnnotationView | Hacking with iOS",desc:"Annotations and accessory views: MKPinAnnotationView",link:"https://hackingwithswift.com/read/16/3/annotations-and-accessory-views-mkpinannotationview",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(174,10,10,0.2)"})),null,16),a(l,{src:"youtube/VkvEA7v5JyQ"}),g,n("p",null,[i("We already used Interface Builder to make our view controller the delegate for the map view, but if you want code completion to work you should also update your code to declare that the class conforms. So, in "),a(r,{icon:"fa-brands fa-swift"}),b,i(", find this line:")]),A])}const I=u(w,[["render",V],["__file","03-annotations-and-accessory-views-mkpinannotationview.html.vue"]]),K=JSON.parse('{"path":"/hackingwithswift.com/read/16/03-annotations-and-accessory-views-mkpinannotationview.html","title":"Annotations and accessory views: MKPinAnnotationView","lang":"ko-KR","frontmatter":{"lang":"ko-KR","title":"Annotations and accessory views: MKPinAnnotationView","description":"Article(s) > Annotations and accessory views: MKPinAnnotationView","category":["Swift","iOS","Article(s)"],"tag":["blog","hackingwithswift.com","crashcourse","swift","xcode","appstore","ios"],"head":[[{"meta":null},{"property":"og:title","content":"Article(s) > Annotations and accessory views: MKPinAnnotationView"},{"property":"og:description","content":"Annotations and accessory views: MKPinAnnotationView"},{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/hackingwithswift.com/read/16/03-annotations-and-accessory-views-mkpinannotationview.html"}],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/hackingwithswift.com/read/16/03-annotations-and-accessory-views-mkpinannotationview.html"}],["meta",{"property":"og:site_name","content":"ðŸ“šBookshelf"}],["meta",{"property":"og:title","content":"Annotations and accessory views: MKPinAnnotationView"}],["meta",{"property":"og:description","content":"Article(s) > Annotations and accessory views: MKPinAnnotationView"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"property":"article:tag","content":"blog"}],["meta",{"property":"article:tag","content":"hackingwithswift.com"}],["meta",{"property":"article:tag","content":"crashcourse"}],["meta",{"property":"article:tag","content":"swift"}],["meta",{"property":"article:tag","content":"xcode"}],["meta",{"property":"article:tag","content":"appstore"}],["meta",{"property":"article:tag","content":"ios"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Annotations and accessory views: MKPinAnnotationView\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[]}"]],"isOriginal":false},"headers":[],"git":{"contributors":[{"name":"chanhi2000","email":"chanhi2000@gmail.com","commits":2}]},"readingTime":{"minutes":3.28,"words":983},"filePathRelative":"hackingwithswift.com/read/16/03-annotations-and-accessory-views-mkpinannotationview.md","excerpt":"\\n"}');export{I as comp,K as data};
