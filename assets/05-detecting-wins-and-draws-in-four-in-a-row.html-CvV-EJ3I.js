import{_ as r}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as u,b as n,t as d,e as a,n as o,g as p,d as s,f as c,r as i,o as k}from"./app-BgNevrm5.js";const h={},m={id:"frontmatter-title-á„€á…ªá†«á„…á…§á†«",tabindex:"-1"},w={class:"header-anchor",href:"#frontmatter-title-á„€á…ªá†«á„…á…§á†«"},f=n("nav",{class:"table-of-contents"},[n("ul")],-1),v=n("hr",null,null,-1),b=n("p",null,"Now it's time to make our game an actual game â€“ i.e., something a player can win. Four in a Row is what's called a zero-sum game, which means for one player to win the other must lose. This in turn means it's very easy to determine a winner: as soon as either player manages to place four chips in a row in any direction, they win. As for detecting a draw, that's just a matter of checking to see if no more moves are available.",-1),g=n("code",null,"isFull()",-1),y=n("code",null,"Board",-1),_=n("code",null,"canMove(in:)",-1),C=n("code",null,"Board.swift",-1),F=c(`<div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">isFull</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Bool</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">for</span> column <span class="token keyword">in</span> <span class="token number">0</span> <span class="token operator">..&lt;</span> <span class="token class-name">Board</span><span class="token punctuation">.</span>width <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token function">canMove</span><span class="token punctuation">(</span><span class="token keyword">in</span><span class="token punctuation">:</span> column<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">return</span> <span class="token boolean">false</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> <span class="token boolean">true</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now for the more challenging method: how to detect when a player has won? In Apple&#39;s original code for this, they took a brute force approach with four different methods for detecting wins: left to right, up to down, and two types of diagonal. It&#39;s probably very efficient code, but it&#39;s unpleasant to read and understand, so I&#39;ve ditched their code and replaced it with something substantially shorter and easier to understand.</p><p>My solution involves two methods: <code>isWin(for:)</code> and <code>squaresMatch(initialChip:)</code>, and we&#39;ll start with the second one first.</p><p>For a player to win, they must have four chips of the same color lined up in a row anywhere on the board. The <code>squaresMatch(initialChip:)</code> method has the job of being given a square on the board and checking for one possible win type. It will accept five parameters:</p><ul><li>The chip color to check.</li><li>The row and column of the initial chip.</li><li>The X and Y movement of our check.</li></ul><p>That last one is the tricky part, so let me explain further. To detect a horizontal win, we&#39;ll call this method with an X movement of 1 and a Y movement of 0. The method can then check a slot, move along by X:1 and Y:0 (i.e., one place to the right), check a second slot, move along by X:1 and Y:0, check a third slot, then move along by X:1 and Y:0 and check the final slot. If all four have matched the player&#39;s chip color, they win.</p><p>The advantage to using this technique is that it can check for all other win types. For example, checking a vertical win means passing an X movement of 0 and a Y movement of 1, and checking a diagonal win means passing an X movement of 1 and a Y movement of 1. Remember, though, that diagonal wins go both up and down, so we need to have a second diagonal check with a Y movement of -1.</p><p>To make the <code>squaresMatch(initialChip:)</code> method safe to call from any slot on the board, we&#39;ll make it return false if it will try to check outside the bounds of the board. For example, if it starts in the bottom left and tries to search for a downward win, we&#39;ll bail out immediately. The method will also return false as soon as it has failed to detect a win for a particular movement, because there&#39;s no point checking slots 3 and 4 if slot 2 doesn&#39;t match the player&#39;s chip color.</p><p>That&#39;s everything you need to know, so here&#39;s the code for <code>squaresMatch(initialChip:)</code> â€“ put this into the <code>Board</code> class:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">squaresMatch</span><span class="token punctuation">(</span>initialChip<span class="token punctuation">:</span> <span class="token class-name">ChipColor</span><span class="token punctuation">,</span> row<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">,</span> col<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">,</span> moveX<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">,</span> moveY<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Bool</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// bail out early if we can&#39;t win from here</span></span>
<span class="line">    <span class="token keyword">if</span> row <span class="token operator">+</span> <span class="token punctuation">(</span>moveY <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">false</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">if</span> row <span class="token operator">+</span> <span class="token punctuation">(</span>moveY <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token class-name">Board</span><span class="token punctuation">.</span>height <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">false</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">if</span> col <span class="token operator">+</span> <span class="token punctuation">(</span>moveX <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">false</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">if</span> col <span class="token operator">+</span> <span class="token punctuation">(</span>moveX <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token class-name">Board</span><span class="token punctuation">.</span>width <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">false</span> <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// still here? Check every square</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token function">chip</span><span class="token punctuation">(</span>inColumn<span class="token punctuation">:</span> col<span class="token punctuation">,</span> row<span class="token punctuation">:</span> row<span class="token punctuation">)</span> <span class="token operator">!=</span> initialChip <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">false</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token function">chip</span><span class="token punctuation">(</span>inColumn<span class="token punctuation">:</span> col <span class="token operator">+</span> moveX<span class="token punctuation">,</span> row<span class="token punctuation">:</span> row <span class="token operator">+</span> moveY<span class="token punctuation">)</span> <span class="token operator">!=</span> initialChip <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">false</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token function">chip</span><span class="token punctuation">(</span>inColumn<span class="token punctuation">:</span> col <span class="token operator">+</span> <span class="token punctuation">(</span>moveX <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> row<span class="token punctuation">:</span> row <span class="token operator">+</span> <span class="token punctuation">(</span>moveY <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> initialChip <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">false</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token function">chip</span><span class="token punctuation">(</span>inColumn<span class="token punctuation">:</span> col <span class="token operator">+</span> <span class="token punctuation">(</span>moveX <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> row<span class="token punctuation">:</span> row <span class="token operator">+</span> <span class="token punctuation">(</span>moveY <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> initialChip <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">false</span> <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> <span class="token boolean">true</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That just leaves one final task before our game starts being useful: we need to fill in the <code>isWin(for:)</code> method so that it loops over every slot in the board, calling <code>squaresMatch(initialChip:)</code> four times for each slot: once for horizontal wins, once for vertical wins, and once for both kinds of diagonal wins. As soon as any of those calls returns true for any slot, the whole method returns true. If the loop finishes with no win, the method will return false so that play continues.</p><p>This also involves one small further change: now that our <code>Player</code> class conforms to <code>GKGameModelPlayer</code>, we need to make the <code>isWin(for:)</code> method accept a <code>GKGameModelPlayer</code> as its parameter. This is whatâ€™s given to us by GameplayKit later on, but we can typecast it back to a regular <code>Player</code> inside the method.</p>`,12),R=n("code",null,"Board.swift",-1),X=c(`<div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token class-name">GameplayKit</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Now replace your existing <code>isWin(for:)</code> method with this updated version:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">isWin</span><span class="token punctuation">(</span><span class="token keyword">for</span> player<span class="token punctuation">:</span> <span class="token class-name">GKGameModelPlayer</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Bool</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> chip <span class="token operator">=</span> <span class="token punctuation">(</span>player <span class="token keyword">as</span><span class="token operator">!</span> <span class="token class-name">Player</span><span class="token punctuation">)</span><span class="token punctuation">.</span>chip</span>
<span class="line"></span>
<span class="line">    <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token number">0</span> <span class="token operator">..&lt;</span> <span class="token class-name">Board</span><span class="token punctuation">.</span>height <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token number">0</span> <span class="token operator">..&lt;</span> <span class="token class-name">Board</span><span class="token punctuation">.</span>width <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">if</span> <span class="token function">squaresMatch</span><span class="token punctuation">(</span>initialChip<span class="token punctuation">:</span> chip<span class="token punctuation">,</span> row<span class="token punctuation">:</span> row<span class="token punctuation">,</span> col<span class="token punctuation">:</span> col<span class="token punctuation">,</span> moveX<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> moveY<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token keyword">return</span> <span class="token boolean">true</span></span>
<span class="line">            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token function">squaresMatch</span><span class="token punctuation">(</span>initialChip<span class="token punctuation">:</span> chip<span class="token punctuation">,</span> row<span class="token punctuation">:</span> row<span class="token punctuation">,</span> col<span class="token punctuation">:</span> col<span class="token punctuation">,</span> moveX<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> moveY<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token keyword">return</span> <span class="token boolean">true</span></span>
<span class="line">            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token function">squaresMatch</span><span class="token punctuation">(</span>initialChip<span class="token punctuation">:</span> chip<span class="token punctuation">,</span> row<span class="token punctuation">:</span> row<span class="token punctuation">,</span> col<span class="token punctuation">:</span> col<span class="token punctuation">,</span> moveX<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> moveY<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token keyword">return</span> <span class="token boolean">true</span></span>
<span class="line">            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token function">squaresMatch</span><span class="token punctuation">(</span>initialChip<span class="token punctuation">:</span> chip<span class="token punctuation">,</span> row<span class="token punctuation">:</span> row<span class="token punctuation">,</span> col<span class="token punctuation">:</span> col<span class="token punctuation">,</span> moveX<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> moveY<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token keyword">return</span> <span class="token boolean">true</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> <span class="token boolean">false</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>At this point, you have a complete two-player Four in a Row game on your hands. If it weren&#39;t for GameplayKit, we&#39;d be done here. But you want to add an AI opponent, don&#39;t you? Sure you do. So go ahead and run your app briefly, marvel at your coding prowess, then get back to Xcode: this is where the difficulty ramps up!</p>`,4);function M(l,Y){const e=i("VPCard"),t=i("FontIcon");return k(),u("div",null,[n("h1",m,[n("a",w,[n("span",null,d(l.$frontmatter.title)+" ê´€ë ¨",1)])]),a(e,o(p({title:"Hacking with iOS â€“ learn to code iPhone and iPad apps with free Swift tutorials",desc:"Learn Swift coding for iOS with these free tutorials â€“ learn Swift, iOS, and Xcode",link:"/hackingwithswift.com/read/README.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(174,10,10,0.2)"})),null,16),f,v,a(e,o(p({title:"Detecting wins and draws in Four in a Row | Hacking with iOS",desc:"Detecting wins and draws in Four in a Row",link:"https://hackingwithswift.com/read/34/5/detecting-wins-and-draws-in-four-in-a-row",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(174,10,10,0.2)"})),null,16),b,n("p",null,[s("Of the two, detecting a draw is far easier, so let's write that first. We already put a stub for "),g,s(" into the "),y,s(" class, but we can fill that out now: it will return false if any column passes the "),_,s(" test, otherwise it will return false. Here's the updated method for "),a(t,{icon:"fa-brands fa-swift"}),C,s(":")]),F,n("p",null,[s("Add this import to "),a(t,{icon:"fa-brands fa-swift"}),R,s(" now:")]),X])}const x=r(h,[["render",M],["__file","05-detecting-wins-and-draws-in-four-in-a-row.html.vue"]]),I=JSON.parse('{"path":"/hackingwithswift.com/read/34/05-detecting-wins-and-draws-in-four-in-a-row.html","title":"Detecting wins and draws in Four in a Row","lang":"ko-KR","frontmatter":{"lang":"ko-KR","title":"Detecting wins and draws in Four in a Row","description":"Article(s) > Detecting wins and draws in Four in a Row","category":["Swift","iOS","Article(s)"],"tag":["blog","hackingwithswift.com","crashcourse","swift","xcode","appstore","ios"],"head":[[{"meta":null},{"property":"og:title","content":"Article(s) > Detecting wins and draws in Four in a Row"},{"property":"og:description","content":"Detecting wins and draws in Four in a Row"},{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/hackingwithswift.com/read/34/05-detecting-wins-and-draws-in-four-in-a-row.html"}],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/hackingwithswift.com/read/34/05-detecting-wins-and-draws-in-four-in-a-row.html"}],["meta",{"property":"og:site_name","content":"ðŸ“šBookshelf"}],["meta",{"property":"og:title","content":"Detecting wins and draws in Four in a Row"}],["meta",{"property":"og:description","content":"Article(s) > Detecting wins and draws in Four in a Row"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"property":"article:tag","content":"blog"}],["meta",{"property":"article:tag","content":"hackingwithswift.com"}],["meta",{"property":"article:tag","content":"crashcourse"}],["meta",{"property":"article:tag","content":"swift"}],["meta",{"property":"article:tag","content":"xcode"}],["meta",{"property":"article:tag","content":"appstore"}],["meta",{"property":"article:tag","content":"ios"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Detecting wins and draws in Four in a Row\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[]}"]],"isOriginal":false},"headers":[],"git":{"contributors":[{"name":"chanhi2000","email":"chanhi2000@gmail.com","commits":2}]},"readingTime":{"minutes":4.11,"words":1233},"filePathRelative":"hackingwithswift.com/read/34/05-detecting-wins-and-draws-in-four-in-a-row.md","excerpt":"\\n"}');export{x as comp,I as data};
