import{_ as k}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as m,b as n,t as h,e as a,n as f,g as w,w as t,d as s,f as o,r as p,o as v}from"./app-BgNevrm5.js";const g={},b={id:"frontmatter-title-관련",tabindex:"-1"},y={class:"header-anchor",href:"#frontmatter-title-관련"},_={class:"table-of-contents"},S=n("hr",null,null,-1),q=n("p",null,"Swift 5.1 has finally landed, albeit slightly incompletely because function builders haven't gone through the Swift Evolution process yet, Still, we are getting another keystone feature in the form of module stability, which allows us to use third-party libraries without worrying which version of the Swift compiler they were built with.",-1),x=n("p",null,[s("Yes, I know that sounds similar to the ABI stability we got in Swift 5.0, but there’s a subtle difference: ABI stability resolves Swift differences at runtime, but "),n("em",null,"module"),s(" stability resolves differences at "),n("em",null,"compile time"),s(".")],-1),I=n("p",null,"Alongside that major milestone we’re also getting a number of important language improvements, and in this article I’ll walk through them and provide code examples so you can see them in action. As you're reading through, chances are you'll see just how many of these features relate to SwiftUI, and in fact I think it's fair to say that SwiftUI would be unrecognizable without the new features introduced with Swift 5.1.",-1),z=n("hr",null,null,-1),j=n("h2",{id:"massive-improvements-to-synthesized-memberwise-initializers",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#massive-improvements-to-synthesized-memberwise-initializers"},[n("span",null,"Massive improvements to synthesized memberwise initializers")])],-1),W={href:"https://github.com/apple/swift-evolution/blob/master/proposals/0242-default-values-memberwise.md",target:"_blank",rel:"noopener noreferrer"},T=n("code",null,"apple/swift-evolution",-1),F=o(`<p>In earlier versions of Swift, a memberwise initializer was automatically created to accept parameters matching the properties of a struct, like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">struct</span> <span class="token class-name">User</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">var</span> name<span class="token punctuation">:</span> <span class="token class-name">String</span></span>
<span class="line">    <span class="token keyword">var</span> loginCount<span class="token punctuation">:</span> <span class="token class-name">Int</span> <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">let</span> piper <span class="token operator">=</span> <span class="token class-name">User</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Piper Chapman&quot;</span></span><span class="token punctuation">,</span> loginCount<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In Swift 5.1 this has been enhanced so that the memberwise initializer now uses default parameter values for any properties that have them. In the <code>User</code> struct we’ve given <code>loginCount</code> a default value of 0, which means we can either specify it or leave it to the memberwise initializer:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> gloria <span class="token operator">=</span> <span class="token class-name">User</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Gloria Mendoza&quot;</span></span><span class="token punctuation">,</span> loginCount<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">let</span> suzanne <span class="token operator">=</span> <span class="token class-name">User</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Suzanne Warren&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>This lets us avoid repeating code, which is always welcome.</p><hr><h2 id="implicit-returns-from-single-expression-functions" tabindex="-1"><a class="header-anchor" href="#implicit-returns-from-single-expression-functions"><span>Implicit returns from single-expression functions</span></a></h2>`,7),A={href:"https://github.com/apple/swift-evolution/blob/master/proposals/0255-omit-return.md",target:"_blank",rel:"noopener noreferrer"},E=n("code",null,"apple/swift-evolution",-1),B=n("code",null,"return",-1),M=o(`<p>In previous versions of Swift, single-line closures that returned a value you could omit the <code>return</code> keyword because the only line of code that was there <em>must</em> be the one that returned a value. So, these two pieces of code were identical:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> doubled1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>map <span class="token punctuation">{</span> <span class="token short-argument">$0</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">let</span> doubled2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>map <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token short-argument">$0</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>In Swift 5.1, this behavior has now been extended to functions as well: if they contain a single expression – effectively a single piece of code that evaluates to a value – then you can leave off the <code>return</code> keyword, like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">double</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> number<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Int</span> <span class="token punctuation">{</span></span>
<span class="line">    number <span class="token operator">*</span> <span class="token number">2</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That will probably cause some people to do a double take at first, but I’m sure it will become second nature over time.</p><hr><h2 id="universal-self" tabindex="-1"><a class="header-anchor" href="#universal-self"><span>Universal <code>Self</code></span></a></h2>`,7),C={href:"https://github.com/apple/swift-evolution/blob/master/proposals/0068-universal-self.md",target:"_blank",rel:"noopener noreferrer"},O=n("code",null,"apple/swift-evolution",-1),N=n("code",null,"Self",-1),R=n("em",null,"dynamic",-1),D=o(`<p>As an example, consider this code:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">class</span> <span class="token class-name">NetworkManager</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">class</span> <span class="token keyword">var</span> maximumActiveRequests<span class="token punctuation">:</span> <span class="token class-name">Int</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token number">4</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">func</span> <span class="token function-definition function">printDebugData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Maximum network requests: </span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation"><span class="token class-name">NetworkManager</span><span class="token punctuation">.</span>maximumActiveRequests</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">.&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That declares a static <code>maximumActiveRequests</code> property for a network manager, and adds a <code>printDebugData()</code> method to print the static property. That works fine right now, but when <code>NetworkManager</code> is subclassed things become more complicated:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">class</span> <span class="token class-name">ThrottledNetworkManager</span><span class="token punctuation">:</span> <span class="token class-name">NetworkManager</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">override</span> <span class="token keyword">class</span> <span class="token keyword">var</span> maximumActiveRequests<span class="token punctuation">:</span> <span class="token class-name">Int</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token number">1</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That subclass changes <code>maximumActiveRequests</code> so that it allows only one request at a time, but if we call <code>printDebugData()</code> it will print out the value from its parent class:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> manager <span class="token operator">=</span> <span class="token class-name">ThrottledNetworkManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">manager<span class="token punctuation">.</span><span class="token function">printDebugData</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>That <em>should</em> print out 1 rather than 4, and that’s where SE-0068 comes in: we can now write <code>Self</code> (with a capital S) to refer to the current type. So, we can rewrite <code>printDebugData()</code> to this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">class</span> <span class="token class-name">ImprovedNetworkManager</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">class</span> <span class="token keyword">var</span> maximumActiveRequests<span class="token punctuation">:</span> <span class="token class-name">Int</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token number">4</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">func</span> <span class="token function-definition function">printDebugData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Maximum network requests: </span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation"><span class="token keyword">Self</span><span class="token punctuation">.</span>maximumActiveRequests</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">.&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This means <code>Self</code> works the same way as it did for protocols in earlier Swift versions.</p><hr><h2 id="opaque-return-types" tabindex="-1"><a class="header-anchor" href="#opaque-return-types"><span>Opaque return types</span></a></h2>`,11),U={href:"https://github.com/apple/swift-evolution/blob/master/proposals/0244-opaque-result-types.md",target:"_blank",rel:"noopener noreferrer"},V=n("code",null,"apple/swift-evolution",-1),P=o(`<p>At first glance that sounds a lot like a protocol, but opaque return types take the concept of protocols significantly further because are able to work with associated types, they require the same type to be used internally each time, and they allow us to hide implementation details.</p><p>As an example, if we wanted to launch different kinds of fighters from a Rebel base we might write code like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">protocol</span> <span class="token class-name">Fighter</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">struct</span> <span class="token class-name">XWing</span><span class="token punctuation">:</span> <span class="token class-name">Fighter</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">func</span> <span class="token function-definition function">launchFighter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Fighter</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token class-name">XWing</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">let</span> red5 <span class="token operator">=</span> <span class="token function">launchFighter</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Whoever calls that function knows it will return some sort of <code>Fighter</code> but doesn’t know precisely what. As a result, we could add <code>struct YWing: Fighter { }</code> or other types, and have any of them be returned.</p><p>But there’s a problem: what if we wanted to check whether a specific fighter was Red 5? You <em>might</em> think the solution is to make <code>Fighter</code> conform to the <code>Equatable</code> protocol so we can use <code>==</code>. However, as soon as you do that Swift will throw up a particularly dreaded error for the <code>launchFighter</code> function: “Protocol &#39;Fighter&#39; can only be used as a generic constraint because it has Self or associated type requirements.”</p><p>The “Self” part of that error is what is hitting us here. The <code>Equatable</code> protocol has to compare two instances of itself (“Self”) to see whether they are the same, but Swift has no guarantee that the two equatable things are remotely the same – we could be comparing a Fighter with an array of integers, for example.</p><p>Opaque types solve this problem because even though <em>we</em> just see a protocol being used, internally the Swift compiler knows exactly what that protocol actually resolves to – it knows it’s an <code>XWing</code>, an array of strings, or whatever.</p><p>To send back an opaque type, use the keyword <code>some</code> before your protocol name:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">launchOpaqueFighter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token keyword">some</span> <span class="token class-name">Fighter</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token class-name">XWing</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>From the caller’s perspective that still gets back a <code>Fighter</code>, which might be an <code>XWing</code>, a <code>YWing</code>, or something else that conforms to the <code>Fighter</code> protocol. But from the <em>compiler’s</em> perspective it knows exactly what is being returned, so it can make sure we follow all the rules correctly.</p><p>For example, consider a function that returned <code>some Equatable</code> like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">makeInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token keyword">some</span> <span class="token class-name">Equatable</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">Int</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token operator">...</span><span class="token number">10</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>When we call that, all we know is that it is some sort of <code>Equatable</code> value, however if call it twice then we can compare the results of those two calls because Swift knows for sure it will be the same underlying type:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> int1 <span class="token operator">=</span> <span class="token function">makeInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">let</span> int2 <span class="token operator">=</span> <span class="token function">makeInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token function">print</span><span class="token punctuation">(</span>int1 <span class="token operator">==</span> int2<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The same is <em>not</em> true if we had a <em>second</em> function that returned <code>some Equatable</code>, like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">makeString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token keyword">some</span> <span class="token class-name">Equatable</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string-literal"><span class="token string">&quot;Red&quot;</span></span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Even though from our perspective both send us back an <code>Equatable</code> type, and we <em>can</em> compare the results of two calls to <code>makeString()</code> or two calls to <code>makeInt()</code>, Swift won’t let us compare the return value of <code>makeString()</code> to the return value of <code>makeInt()</code> because it knows comparing a string and an integer doesn’t make any sense.</p><p>An important proviso here is that functions with opaque return types must always return one specific type. If for example we tried to use <code>Bool.random()</code> to randomly launch an <code>XWing</code> or a <code>YWing</code> then Swift would refuse to build our code because the compiler can no longer tell what will be sent back.</p><p>You might well think “if we always need to return the same type, why not just write the function as <code>func launchFighter() -&gt; XWing</code>? While that might work sometimes, it creates new problems such as:</p><ul><li>We end up with types we don’t really want to expose to the world. For example, if we used <code>someArray.lazy.drop { … }</code> we get sent back a <code>LazyDropWhileSequence</code> – a dedicated and highly specific type from the Swift standard library. All we actually care about is that this thing is a sequence; we don’t need to know how Swift’s internals work.</li><li>We lose the ability to change our mind later. Making <code>launchFighter()</code> return only an <code>XWing</code> means we can’t switch to a different type in the future, and given how much Disney relies on Star Wars toy sales that would be a problem! By returning an opaque type we can return X-Wings today, then move to B-Wings in a year – we only ever return one in any given build of our code, but we can still have the flexibility to change our mind.</li></ul><p>In some respects all this might sound similar to generics, which also solve the “Self or associated type requirements” problem. Generics allow us to write code like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">protocol</span> <span class="token class-name">ImperialFighter</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">struct</span> <span class="token class-name">TIEFighter</span><span class="token punctuation">:</span> <span class="token class-name">ImperialFighter</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">struct</span> <span class="token class-name">TIEAdvanced</span><span class="token punctuation">:</span> <span class="token class-name">ImperialFighter</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">func</span> <span class="token function-definition function">launchImperialFighter</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">ImperialFighter</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token class-name">T</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That defines a new protocol that requires conforming types to be initializable with no parameters, defines two structs that conform to that protocol, then creates a generic function to use it. However, the difference here is that now <em>callers</em> of <code>launchImperialFighter()</code> are the ones to choose what kind of fighter they get, like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> fighter1<span class="token punctuation">:</span> <span class="token class-name">TIEFighter</span> <span class="token operator">=</span> <span class="token function">launchImperialFighter</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">let</span> fighter2<span class="token punctuation">:</span> <span class="token class-name">TIEAdvanced</span> <span class="token operator">=</span> <span class="token function">launchImperialFighter</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>If you <em>want</em> callers to be able to select their data type then generics work well, but if you want the <em>function</em> to decide the return type then they fall down;</p><p>So, opaque result types allow us to do several things:</p><ul><li>Our functions decide what type of data gets returned, not the caller of those functions.</li><li>We don’t need to worry about Self or associated type requirements, because the compiler knows exactly what type is inside.</li><li>We get to change our minds in the future whenever we need to.</li><li>We don’t expose private internal types to the outside world.</li></ul><hr><h2 id="static-and-class-subscripts" tabindex="-1"><a class="header-anchor" href="#static-and-class-subscripts"><span>Static and class subscripts</span></a></h2>`,29),X={href:"https://github.com/apple/swift-evolution/blob/master/proposals/0254-static-subscripts.md",target:"_blank",rel:"noopener noreferrer"},Y=n("code",null,"apple/swift-evolution",-1),G=n("em",null,"static",-1),H=o(`<p>Static properties and methods are used when one set of values is shared between all instances of that type. For example, if you had one centralized type to store your app settings, you might write code like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">OldSettings</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">var</span> values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">static</span> <span class="token keyword">func</span> <span class="token function-definition function">get</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">String</span><span class="token operator">?</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> values<span class="token punctuation">[</span>name<span class="token punctuation">]</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">static</span> <span class="token keyword">func</span> <span class="token function-definition function">set</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> to newValue<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Adjusting </span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">name</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string"> to </span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">newValue <span class="token operator">??</span> <span class="token string-literal"><span class="token string">&quot;nil&quot;</span></span></span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        values<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> newValue</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token class-name">OldSettings</span><span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Captain&quot;</span></span><span class="token punctuation">,</span> to<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Gary&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"><span class="token class-name">OldSettings</span><span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Friend&quot;</span></span><span class="token punctuation">,</span> to<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Mooncake&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"><span class="token function">print</span><span class="token punctuation">(</span><span class="token class-name">OldSettings</span><span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Captain&quot;</span></span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token string-literal"><span class="token string">&quot;Unknown&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Wrapping the dictionary inside a type means that we can control access more carefully, and using an enum with no cases means we can’t try to instantiate the type – we can’t make various instances of <code>Settings</code>.</p><p>With Swift 5.1 we can now use a static subscript instead, allowing us to rewrite our code to this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">NewSettings</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">var</span> values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">subscript</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">String</span><span class="token operator">?</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">get</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">return</span> values<span class="token punctuation">[</span>name<span class="token punctuation">]</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword">set</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Adjusting </span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">name</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string"> to </span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">newValue <span class="token operator">??</span> <span class="token string-literal"><span class="token string">&quot;nil&quot;</span></span></span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">            values<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> newValue</span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token class-name">NewSettings</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;Captain&quot;</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;Gary&quot;</span></span></span>
<span class="line"><span class="token class-name">NewSettings</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;Friend&quot;</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;Mooncake&quot;</span></span></span>
<span class="line"><span class="token function">print</span><span class="token punctuation">(</span><span class="token class-name">NewSettings</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;Captain&quot;</span></span><span class="token punctuation">]</span> <span class="token operator">??</span> <span class="token string-literal"><span class="token string">&quot;Unknown&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Custom subscripts like this have always been possible for instances of types; this improvement makes static or class subscripts possible too.</p><hr><h2 id="warnings-for-ambiguous-none-cases" tabindex="-1"><a class="header-anchor" href="#warnings-for-ambiguous-none-cases"><span>Warnings for ambiguous <code>none</code> cases</span></a></h2><p>Swift’s optionals are implemented as an enum of two cases: <code>some</code> and <code>none</code>. This gave rise to the possibility of confusion if we created our own enums that had a <code>none</code> case, then wrapped that inside an optional.</p><p>For example:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">enum</span> <span class="token class-name">BorderStyle</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">case</span> <span class="token keyword">none</span></span>
<span class="line">    <span class="token keyword">case</span> <span class="token function">solid</span><span class="token punctuation">(</span>thickness<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Used as a non-optional this was always clear:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> border1<span class="token punctuation">:</span> <span class="token class-name">BorderStyle</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token keyword">none</span></span>
<span class="line"><span class="token function">print</span><span class="token punctuation">(</span>border1<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>That will print “none”. But if we used an optional for that enum – if we didn’t know what border style to use – then we’d hit problems:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> border2<span class="token punctuation">:</span> <span class="token class-name">BorderStyle</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token keyword">none</span></span>
<span class="line"><span class="token function">print</span><span class="token punctuation">(</span>border2<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>That prints “nil”, because Swift assumes <code>.none</code> means the optional is empty, rather than an optional with the value <code>BorderStyle.none</code>.</p><p>In Swift 5.1 this confusion now prints a warning: “Assuming you mean &#39;Optional.none&#39;; did you mean &#39;BorderStyle.none&#39; instead?” This avoids the source compatibility breakage of an error, but at least informs developers that their code might not quite mean what they thought.</p><hr><h2 id="matching-optional-enums-against-non-optionals" tabindex="-1"><a class="header-anchor" href="#matching-optional-enums-against-non-optionals"><span>Matching optional enums against non-optionals</span></a></h2><p>Swift has always been smart enough to handle switch/case pattern matching between optionals and non-optionals for strings and integers, but before Swift 5.1 that wasn’t extended to enums.</p><p>Well, in Swift 5.1 we can now use switch/case pattern matching to match optional enums with non-optionals, like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">enum</span> <span class="token class-name">BuildStatus</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">case</span> starting</span>
<span class="line">    <span class="token keyword">case</span> inProgress</span>
<span class="line">    <span class="token keyword">case</span> complete</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">let</span> status<span class="token punctuation">:</span> <span class="token class-name">BuildStatus</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token punctuation">.</span>inProgress</span>
<span class="line"></span>
<span class="line"><span class="token keyword">switch</span> status <span class="token punctuation">{</span></span>
<span class="line"><span class="token keyword">case</span> <span class="token punctuation">.</span>inProgress<span class="token punctuation">:</span></span>
<span class="line">    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Build is starting…&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">case</span> <span class="token punctuation">.</span>complete<span class="token punctuation">:</span></span>
<span class="line">    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Build is complete!&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">default</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Some other build status&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Swift is able to compare the optional enum directly with the non-optional cases, so that code will print “Build is starting…”</p><hr><h2 id="ordered-collection-diffing" tabindex="-1"><a class="header-anchor" href="#ordered-collection-diffing"><span>Ordered collection diffing</span></a></h2>`,25),K={href:"https://github.com/apple/swift-evolution/blob/master/proposals/0240-ordered-collection-diffing.md",target:"_blank",rel:"noopener noreferrer"},L=n("code",null,"apple/swift-evolution",-1),Z=o(`<p>The basic principle is straightforward: Swift 5.1 gives us a new <code>difference(from:)</code> method that calculates the differences between two ordered collections – what items to remove and what items to insert. This can be used with any ordered collection that contains <code>Equatable</code> elements.</p><p>To demonstrate this, we can create an array of scores, calculate the difference from one to the other, then loop over those differences and apply each one to make our two collections the same.</p><div class="hint-container note"><p class="hint-container-title">Note</p><p>Because Swift now ships inside Apple’s operating systems, new features like this one must be used with an <code>#available</code> check to make sure the code is being run on an OS that includes the new functionality. For features that will land in an unknown, unannounced operating system shipping at some point in the future, a special version number of “9999” is used to mean “we don’t know what the actual number is just yet.”</p></div><p>Here’s the code:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">var</span> scores1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">91</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">let</span> scores2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">,</span> <span class="token number">91</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> <span class="token other-directive property">#available</span><span class="token punctuation">(</span>iOS <span class="token number">9999</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> diff <span class="token operator">=</span> scores2<span class="token punctuation">.</span><span class="token function">difference</span><span class="token punctuation">(</span>from<span class="token punctuation">:</span> scores1<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">for</span> change <span class="token keyword">in</span> diff <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">switch</span> change <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">let</span> offset<span class="token punctuation">,</span> <span class="token omit keyword">_</span><span class="token punctuation">,</span> <span class="token omit keyword">_</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            scores1<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>at<span class="token punctuation">:</span> offset<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">let</span> offset<span class="token punctuation">,</span> <span class="token keyword">let</span> element<span class="token punctuation">,</span> <span class="token omit keyword">_</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            scores1<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> at<span class="token punctuation">:</span> offset<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token function">print</span><span class="token punctuation">(</span>scores1<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>For more advanced animations, you can use the third value of the changes: <code>associatedWith</code>. So, rather than using <code>.insert(let offset, let element, _)</code> above you might write <code>.insert(let offset, let element, let associatedWith)</code> instead. This lets you track pairs of changes at the same time: moving an item two places down in your collection is a removal then an insertion, but the <code>associatedWith</code> value ties those two changes together so you treat it as a move instead.</p><p>Rather than applying changes by hand, you can apply the whole collection using a new <code>applying()</code> method, like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">if</span> <span class="token other-directive property">#available</span><span class="token punctuation">(</span>iOS <span class="token number">9999</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> diff <span class="token operator">=</span> scores2<span class="token punctuation">.</span><span class="token function">difference</span><span class="token punctuation">(</span>from<span class="token punctuation">:</span> scores1<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">let</span> result <span class="token operator">=</span> scores1<span class="token punctuation">.</span><span class="token function">applying</span><span class="token punctuation">(</span>diff<span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="creating-uninitialized-arrays" tabindex="-1"><a class="header-anchor" href="#creating-uninitialized-arrays"><span>Creating uninitialized arrays</span></a></h2>`,10),$={href:"https://github.com/apple/swift-evolution/blob/master/proposals/0245-array-uninitialized-initializer.md",target:"_blank",rel:"noopener noreferrer"},J=n("code",null,"apple/swift-evolution",-1),Q=o(`<p>To use the initializer, tell it the capacity you want, then provide a closure to fill in the values however you need. Your closure will be given an unsafe mutable buffer pointer where you can write your values, as well as an <code>inout</code> second parameter that lets you report back how many values you actually used.</p><p>For example, we could make an array of 10 random integers like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> randomNumbers <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token operator">&lt;</span><span class="token class-name">Int</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>unsafeUninitializedCapacity<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> buffer<span class="token punctuation">,</span> initializedCount <span class="token keyword">in</span></span>
<span class="line">    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token number">0</span><span class="token operator">..&lt;</span><span class="token number">10</span> <span class="token punctuation">{</span></span>
<span class="line">        buffer<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Int</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token operator">...</span><span class="token number">10</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    initializedCount <span class="token operator">=</span> <span class="token number">10</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>There are some rules here:</p><ol><li>You don’t need to use all the capacity you ask for, but you can’t go <em>over</em> capacity. So, if you ask for a capacity of 10 you can set <code>initializedCount</code> to 0 through 10, but not 11.</li><li>If you don’t initialize elements that end up being in your array – for example if you set <code>initializedCount</code> to 5 but don’t actually provide values for elements 0 through 4 – then they are likely to be filled with random data. This is A Bad Idea.</li><li>If you don’t set <code>initializedCount</code> it will be 0, so any data you assigned will be lost.</li></ol><p>Now, we <em>could</em> have rewritten the above code using <code>map()</code>, like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> randomNumbers2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">...</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>map <span class="token punctuation">{</span> <span class="token omit keyword">_</span> <span class="token keyword">in</span> <span class="token class-name">Int</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token operator">...</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>That’s certainly easier to read, but it’s less efficient: it creates a range, creates a new empty array, sizes it up to the correct amount, loops over the range, and calls the closure once for each range item.</p><hr><h2 id="more-to-come" tabindex="-1"><a class="header-anchor" href="#more-to-come"><span>More to come!</span></a></h2>`,10),nn={href:"https://swift.org/blog/5-1-release-process/",target:"_blank",rel:"noopener noreferrer"},sn={href:"https://forums.swift.org/t/update-on-module-stability-and-module-interface-files/23337",target:"_blank",rel:"noopener noreferrer"},an={href:"https://swift.org/blog/5-1-release-process/",target:"_blank",rel:"noopener noreferrer"},en=n("p",null,[s("One thing that deserves special mention is that two of the changes listed here weren’t introduced as a result of Swift Evolution. Instead, the changes – “Warnings for ambiguous "),n("code",null,"none"),s(" cases” and “Matching optional enums against non-optionals” – were picked up as bugs and corrected quickly.")],-1),tn={href:"https://x.com/suyashsrijan",target:"_blank",rel:"noopener noreferrer"},on={href:"http://bit.ly/starterbugs",target:"_blank",rel:"noopener noreferrer"};function pn(c,ln){const r=p("VPCard"),i=p("router-link"),u=p("SiteInfo"),l=p("RouteLink"),d=p("VidStack"),e=p("FontIcon");return v(),m("div",null,[n("h1",b,[n("a",y,[n("span",null,h(c.$frontmatter.title)+" 관련",1)])]),a(r,f(w({title:"Swift > Article(s)",desc:"Article(s)",link:"/programming/swift/articles/README.md",logo:"/images/ico-wind.svg",background:"rgba(10,10,10,0.2)"})),null,16),n("nav",_,[n("ul",null,[n("li",null,[a(i,{to:"#massive-improvements-to-synthesized-memberwise-initializers"},{default:t(()=>[s("Massive improvements to synthesized memberwise initializers")]),_:1})]),n("li",null,[a(i,{to:"#implicit-returns-from-single-expression-functions"},{default:t(()=>[s("Implicit returns from single-expression functions")]),_:1})]),n("li",null,[a(i,{to:"#universal-self"},{default:t(()=>[s("Universal Self")]),_:1})]),n("li",null,[a(i,{to:"#opaque-return-types"},{default:t(()=>[s("Opaque return types")]),_:1})]),n("li",null,[a(i,{to:"#static-and-class-subscripts"},{default:t(()=>[s("Static and class subscripts")]),_:1})]),n("li",null,[a(i,{to:"#warnings-for-ambiguous-none-cases"},{default:t(()=>[s("Warnings for ambiguous none cases")]),_:1})]),n("li",null,[a(i,{to:"#matching-optional-enums-against-non-optionals"},{default:t(()=>[s("Matching optional enums against non-optionals")]),_:1})]),n("li",null,[a(i,{to:"#ordered-collection-diffing"},{default:t(()=>[s("Ordered collection diffing")]),_:1})]),n("li",null,[a(i,{to:"#creating-uninitialized-arrays"},{default:t(()=>[s("Creating uninitialized arrays")]),_:1})]),n("li",null,[a(i,{to:"#more-to-come"},{default:t(()=>[s("More to come!")]),_:1})])])]),S,a(u,{name:"What's new in Swift 5.1 – Hacking with Swift",desc:"Opaque return types, implicit returns, universal self, and more",url:"https://hackingwithswift.com/articles/182/whats-new-in-swift-5-1",logo:"https://hackingwithswift.com/favicon.svg",preview:"https://hackingwithswift.com/uploads/swift-evolution-1.jpg"}),q,x,I,n("ul",null,[n("li",null,[s("If you missed all the new features in Swift 5.1, start here: "),a(l,{to:"/hackingwithswift.com/whats-new-in-swift-5-0.html"},{default:t(()=>[s("what's new in Swift 5.0")]),_:1}),s(".")]),n("li",null,[s("I have a free online book on SwiftUI called "),a(l,{to:"/hackingwithswift.com/swiftui/"},{default:t(()=>[s("SwiftUI By Example")]),_:1}),s(" – if you want to see these new Swift 5.1 features in action that's the place to start.")])]),a(d,{src:"youtube/WQ-wppW8jt4"}),z,j,n("p",null,[n("a",W,[s("SE-0242 ("),a(e,{icon:"iconfont icon-github"}),T,s(")")]),s(" introduces major improvements to one of Swift’s most commonly used features: memberwise initializers for structs.")]),F,n("p",null,[n("a",A,[s("SE-0255 ("),a(e,{icon:"iconfont icon-github"}),E,s(")")]),s(" has removed a small but important inconsistency in the language: single-expression functions that return a value can now remove the "),B,s(" keyword and Swift will understand it implicitly.")]),M,n("p",null,[n("a",C,[s("SE-0068 ("),a(e,{icon:"iconfont icon-github"}),O,s(")")]),s(" expands Swift’s use of "),N,s(" so that it refers to the containing type when used inside classes, structs, and enums. This is particularly useful for "),R,s(" types, where the exact type of something needs to be determined at runtime.")]),D,n("p",null,[n("a",U,[s("SE-0244 ("),a(e,{icon:"iconfont icon-github"}),V,s(")")]),s(" introduces the concept of opaque types into Swift. An opaque type is one where we’re told about the capabilities of an object without knowing specifically what kind of object it is.")]),P,n("p",null,[n("a",X,[s("SE-0254 ("),a(e,{icon:"iconfont icon-github"}),Y,s(")")]),s(" adds the ability to mark subscripts as being "),G,s(", which means they apply to types rather than instances of a type.")]),H,n("p",null,[n("a",K,[s("SE-0240 ("),a(e,{icon:"iconfont icon-github"}),L,s(")")]),s(" introduces the ability to calculate and apply the differences between ordered collections. This could prove particularly interesting for developers who have complex collections in table views, where they want to add and remove lots of items smoothly using animations.")]),Z,n("p",null,[n("a",$,[s("SE-0245 ("),a(e,{icon:"iconfont icon-github"}),J,s(")")]),s(" introduces a new initializer for arrays that doesn’t pre-fill values with a default. This was previously available as a private API, which meant Xcode wouldn’t list it in its code completion but you could still use it if you wanted – and if you were happy to take the risk that it wouldn’t be withdrawn in the future!")]),Q,n("p",null,[s("Swift 5.1 is still under development, and although the "),n("a",nn,[a(e,{icon:"fa-brands fa-swift"}),s("final branching for Swift itself has passed")]),s(" there is still scope to see changes from some of the other associated projects.")]),n("p",null,[s("Again, the big feature here is module stability, and I know "),n("a",sn,[a(e,{icon:"fa-brands fa-swift"}),s("the team are working hard on getting that right")]),s(". They don’t announce shipping dates, although "),n("a",an,[a(e,{icon:"fa-brands fa-swift"}),s("they have said")]),s(" that 5.1 “has a significantly shorter development” as a result of Swift 5.0 requiring “an unusual amount of focus and attention” – I’m guessing we’ll see a beta at WWDC19, but obviously this isn’t something to be rushed for a particular date.")]),en,n("p",null,[s("These are great quality of life improvements in Swift, but the reason I’m calling them out specially is because they were both fixed by a community contributor: "),n("a",tn,[a(e,{icon:"fa-brands fa-x-twitter"}),s("Suyash Srijan")]),s(". It’s fantastic to see development of Swift continue to grow beyond Apple, and Suyash’s work on those two highly visible features is helping make Swift easier and more consistent for everyone.")]),n("p",null,[s("Best of all, the ambiguous enum bug was filed as a starter bug, which is one that the Swift team have picked out specifically to make it easier for folks to get started contributing. If you’d like to explore the current starter bugs for yourself, and perhaps even take a shot at fixing one, visit "),n("a",on,[a(e,{icon:"fas fa-globe"}),s("http://bit.ly/starterbugs")]),s(".")])])}const un=k(g,[["render",pn],["__file","whats-new-in-swift-5-1.html.vue"]]),dn=JSON.parse(`{"path":"/hackingwithswift.com/whats-new-in-swift-5-1.html","title":"What's new in Swift 5.1","lang":"ko-KR","frontmatter":{"lang":"ko-KR","title":"What's new in Swift 5.1","description":"Opaque return types, implicit returns, universal self, and more","icon":"fa-brands fa-swift","category":["Swift","Article(s)"],"tag":["blog","hackingwithswift.com","crashcourse","swift","swift-5.0","ios","xcode"],"head":[[{"meta":null},{"property":"og:title","content":"What's new in Swift 5.1"},{"property":"og:description","content":"Opaque return types, implicit returns, universal self, and more"},{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/hackingwithswift.com/whats-new-in-swift-5-1.html"}],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/hackingwithswift.com/whats-new-in-swift-5-1.html"}],["meta",{"property":"og:site_name","content":"📚Bookshelf"}],["meta",{"property":"og:title","content":"What's new in Swift 5.1"}],["meta",{"property":"og:description","content":"Opaque return types, implicit returns, universal self, and more"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://hackingwithswift.com/uploads/swift-evolution-1.jpg"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:src","content":"https://hackingwithswift.com/uploads/swift-evolution-1.jpg"}],["meta",{"name":"twitter:image:alt","content":"What's new in Swift 5.1"}],["meta",{"property":"article:tag","content":"blog"}],["meta",{"property":"article:tag","content":"hackingwithswift.com"}],["meta",{"property":"article:tag","content":"crashcourse"}],["meta",{"property":"article:tag","content":"swift"}],["meta",{"property":"article:tag","content":"swift-5.0"}],["meta",{"property":"article:tag","content":"ios"}],["meta",{"property":"article:tag","content":"xcode"}],["meta",{"property":"article:published_time","content":"2019-09-18T00:00:00.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"What's new in Swift 5.1\\",\\"image\\":[\\"https://hackingwithswift.com/uploads/swift-evolution-1.jpg\\"],\\"datePublished\\":\\"2019-09-18T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[]}"]],"prev":"/programming/swift/articles/README.md","date":"2019-09-18T00:00:00.000Z","isOriginal":false,"cover":"https://hackingwithswift.com/uploads/swift-evolution-1.jpg"},"headers":[{"level":2,"title":"Massive improvements to synthesized memberwise initializers","slug":"massive-improvements-to-synthesized-memberwise-initializers","link":"#massive-improvements-to-synthesized-memberwise-initializers","children":[]},{"level":2,"title":"Implicit returns from single-expression functions","slug":"implicit-returns-from-single-expression-functions","link":"#implicit-returns-from-single-expression-functions","children":[]},{"level":2,"title":"Universal Self","slug":"universal-self","link":"#universal-self","children":[]},{"level":2,"title":"Opaque return types","slug":"opaque-return-types","link":"#opaque-return-types","children":[]},{"level":2,"title":"Static and class subscripts","slug":"static-and-class-subscripts","link":"#static-and-class-subscripts","children":[]},{"level":2,"title":"Warnings for ambiguous none cases","slug":"warnings-for-ambiguous-none-cases","link":"#warnings-for-ambiguous-none-cases","children":[]},{"level":2,"title":"Matching optional enums against non-optionals","slug":"matching-optional-enums-against-non-optionals","link":"#matching-optional-enums-against-non-optionals","children":[]},{"level":2,"title":"Ordered collection diffing","slug":"ordered-collection-diffing","link":"#ordered-collection-diffing","children":[]},{"level":2,"title":"Creating uninitialized arrays","slug":"creating-uninitialized-arrays","link":"#creating-uninitialized-arrays","children":[]},{"level":2,"title":"More to come!","slug":"more-to-come","link":"#more-to-come","children":[]}],"git":{"contributors":[{"name":"chanhi2000","email":"chanhi2000@gmail.com","commits":2}]},"readingTime":{"minutes":11.81,"words":3542},"filePathRelative":"hackingwithswift.com/whats-new-in-swift-5-1.md","localizedDate":"2019년 9월 18일","excerpt":"\\n"}`);export{un as comp,dn as data};
