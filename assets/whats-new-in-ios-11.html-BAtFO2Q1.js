import{_ as d}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as k,b as n,t as h,e as a,n as l,g as c,w as i,d as s,f as t,r,o as m}from"./app-BgNevrm5.js";const w={},v={id:"frontmatter-title-관련",tabindex:"-1"},g={class:"header-anchor",href:"#frontmatter-title-관련"},f={class:"table-of-contents"},b=n("hr",null,null,-1),y=n("p",null,"iOS 11 was announced at WWDC 2017, and introduces a massive collection of powerful features such as Core ML, ARKit, Vision, PDFKit, MusicKit, drag and drop, and more. I've tried to summarize the key changes below so you can get started with them straight away, providing code where feasible.",-1),I=n("div",{class:"hint-container warning"},[n("p",{class:"hint-container-title"},"Warning"),n("p",null,"Some of these features are not for the faint hearted. I've provided as much code as I can to help give you a head start with working apps, but ultimately a great deal of iOS 11 involves complex functionality that you simply can't avoid.")],-1),x=n("p",null,"Before you continue, you might find these articles useful pre-reading:",-1),_=t('<hr><h2 id="drag-and-drop" tabindex="-1"><a class="header-anchor" href="#drag-and-drop"><span>Drag and drop</span></a></h2><p>Drag and drop is something we&#39;ve always taken for granted on desktop operating systems, but its absence on iOS really held back multitasking – until iOS 11, that is. In iOS 11, and particularly on iPad, multitasking has gone into overdrive, with drag and drop being a huge part of that: you can move content inside apps or between apps, you can use your other hand to manipulate apps while dragging, and you can even use the new dock system to activate other apps mid-drag.</p><div class="hint-container note"><p class="hint-container-title">Note</p><p>on iPhone drag and drop is limited to a single app – you can&#39;t drag content to other apps.</p></div><p>Helpfully, both <code>UITableView</code> and <code>UICollectionView</code> both come with some degree of drag and drop support built in, but there&#39;s still a fair amount of code to write in order to get them working. You can also add drag and drop support to other components, and as you&#39;ll see this actually takes less work.</p><p>Let&#39;s take a look at how to implement simple drag and drop to let you copy rows between two tables. First, we need a basic app to work with, so we&#39;re going to write some code to create two table views filled with example data we can copy.</p>',6),C=n("code",null,"ViewController.swift",-1),S=t("<p>Now we need to put two table views in there, both filled with dummy data. I&#39;m not going to use IB here because it&#39;s clearer just to write it all in code. That being said, I&#39;m <em>not</em> going to explain this code in detail because it&#39;s just existing iOS code and I don&#39;t want to waste your time.</p><p>This code will:</p><ul><li>Create two table views, and create two string array filled with &quot;Left&quot; and &quot;Right&quot;.</li><li>Configure both table views to use the view controller as their data source, give them hard-coded frames, register a re-use cell, then add them to the view.</li><li>Implement <code>numberOfRowsInSection</code> so that each table view has the correct number of items based on its string array.</li><li>Implement <code>cellForRowAt</code> to dequeue and cell then show the correct item from one of the two string arrays depending on which table this is.</li></ul>",3),V=n("code",null,"ViewController.swift",-1),D=t(`<div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token class-name">UIKit</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">ViewController</span><span class="token punctuation">:</span> <span class="token class-name">UIViewController</span><span class="token punctuation">,</span> <span class="token class-name">UITableViewDataSource</span><span class="token punctuation">,</span> <span class="token class-name">UITableViewDelegate</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">var</span> leftTableView <span class="token operator">=</span> <span class="token class-name">UITableView</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">var</span> rightTableView <span class="token operator">=</span> <span class="token class-name">UITableView</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">var</span> leftItems <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span><span class="token punctuation">(</span>repeating<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Left&quot;</span></span><span class="token punctuation">,</span> count<span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">var</span> rightItems <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span><span class="token punctuation">(</span>repeating<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Right&quot;</span></span><span class="token punctuation">,</span> count<span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">override</span> <span class="token keyword">func</span> <span class="token function-definition function">viewDidLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">viewDidLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        leftTableView<span class="token punctuation">.</span>dataSource <span class="token operator">=</span> <span class="token keyword">self</span></span>
<span class="line">        rightTableView<span class="token punctuation">.</span>dataSource <span class="token operator">=</span> <span class="token keyword">self</span></span>
<span class="line"></span>
<span class="line">        leftTableView<span class="token punctuation">.</span>frame <span class="token operator">=</span> <span class="token class-name">CGRect</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">40</span><span class="token punctuation">,</span> width<span class="token punctuation">:</span> <span class="token number">150</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token number">400</span><span class="token punctuation">)</span></span>
<span class="line">        rightTableView<span class="token punctuation">.</span>frame <span class="token operator">=</span> <span class="token class-name">CGRect</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token number">150</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">40</span><span class="token punctuation">,</span> width<span class="token punctuation">:</span> <span class="token number">150</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token number">400</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        leftTableView<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token class-name">UITableViewCell</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">,</span> forCellReuseIdentifier<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Cell&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        rightTableView<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token class-name">UITableViewCell</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">,</span> forCellReuseIdentifier<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Cell&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        view<span class="token punctuation">.</span><span class="token function">addSubview</span><span class="token punctuation">(</span>leftTableView<span class="token punctuation">)</span></span>
<span class="line">        view<span class="token punctuation">.</span><span class="token function">addSubview</span><span class="token punctuation">(</span>rightTableView<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">func</span> <span class="token function-definition function">tableView</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> tableView<span class="token punctuation">:</span> <span class="token class-name">UITableView</span><span class="token punctuation">,</span> numberOfRowsInSection section<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Int</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">if</span> tableView <span class="token operator">==</span> leftTableView <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">return</span> leftItems<span class="token punctuation">.</span>count</span>
<span class="line">        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">return</span> rightItems<span class="token punctuation">.</span>count</span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">func</span> <span class="token function-definition function">tableView</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> tableView<span class="token punctuation">:</span> <span class="token class-name">UITableView</span><span class="token punctuation">,</span> cellForRowAt indexPath<span class="token punctuation">:</span> <span class="token class-name">IndexPath</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">UITableViewCell</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">let</span> cell <span class="token operator">=</span> tableView<span class="token punctuation">.</span><span class="token function">dequeueReusableCell</span><span class="token punctuation">(</span>withIdentifier<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Cell&quot;</span></span><span class="token punctuation">,</span> <span class="token keyword">for</span><span class="token punctuation">:</span> indexPath<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">if</span> tableView <span class="token operator">==</span> leftTableView <span class="token punctuation">{</span></span>
<span class="line">            cell<span class="token punctuation">.</span>textLabel<span class="token operator">?</span><span class="token punctuation">.</span>text <span class="token operator">=</span> leftItems<span class="token punctuation">[</span>indexPath<span class="token punctuation">.</span>row<span class="token punctuation">]</span></span>
<span class="line">        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">            cell<span class="token punctuation">.</span>textLabel<span class="token operator">?</span><span class="token punctuation">.</span>text <span class="token operator">=</span> rightItems<span class="token punctuation">[</span>indexPath<span class="token punctuation">.</span>row<span class="token punctuation">]</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">return</span> cell</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>OK: now for the <em>new</em> stuff. If you run the app you&#39;ll see it gives us two side-by-side table views filled with items. What we want to do is let the user grab an item from one table and copy it into the other, in either direction.</p><p>The first step is to tell both table views to use the current view controller as their drag and drop delegate, then enable drag interaction on both of them. Add this code to <code>viewDidLoad()</code>:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line">leftTableView<span class="token punctuation">.</span>dragDelegate <span class="token operator">=</span> <span class="token keyword">self</span></span>
<span class="line">leftTableView<span class="token punctuation">.</span>dropDelegate <span class="token operator">=</span> <span class="token keyword">self</span></span>
<span class="line">rightTableView<span class="token punctuation">.</span>dragDelegate <span class="token operator">=</span> <span class="token keyword">self</span></span>
<span class="line">rightTableView<span class="token punctuation">.</span>dropDelegate <span class="token operator">=</span> <span class="token keyword">self</span></span>
<span class="line"></span>
<span class="line">leftTableView<span class="token punctuation">.</span>dragInteractionEnabled <span class="token operator">=</span> <span class="token boolean">true</span></span>
<span class="line">rightTableView<span class="token punctuation">.</span>dragInteractionEnabled <span class="token operator">=</span> <span class="token boolean">true</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>As soon as you do that, Xcode will throw up several warnings because our current view controller class doesn&#39;t conform to the <code>UITableViewDragDelegate</code> or <code>UITableViewDropDelegate</code> protocols. This is easily fixed by adding those two protocols to our class – scroll up to the top and change the class definition to this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">class</span> <span class="token class-name">ViewController</span><span class="token punctuation">:</span> <span class="token class-name">UIViewController</span><span class="token punctuation">,</span> <span class="token class-name">UITableViewDataSource</span><span class="token punctuation">,</span> <span class="token class-name">UITableViewDelegate</span><span class="token punctuation">,</span> <span class="token class-name">UITableViewDragDelegate</span><span class="token punctuation">,</span> <span class="token class-name">UITableViewDropDelegate</span> <span class="token punctuation">{</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>This in turn creates another problem: we&#39;re saying we conform to those two new protocols, but we aren&#39;t implementing their required methods. This used to be a real drag (sorry not sorry) to fix, but Xcode 9 can automatically complete required methods for protocols – click the number &quot;2&quot; on the red highlighted line of code, and you should see a more detailed explanation appear. Click &quot;Fix&quot; to have Xcode insert the two missing methods for us – you should see this appear in your class:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">tableView</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> tableView<span class="token punctuation">:</span> <span class="token class-name">UITableView</span><span class="token punctuation">,</span> itemsForBeginning session<span class="token punctuation">:</span> <span class="token class-name">UIDragSession</span><span class="token punctuation">,</span> at indexPath<span class="token punctuation">:</span> <span class="token class-name">IndexPath</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">[</span><span class="token class-name">UIDragItem</span><span class="token punctuation">]</span> <span class="token punctuation">{</span></span>
<span class="line">    code</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">func</span> <span class="token function-definition function">tableView</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> tableView<span class="token punctuation">:</span> <span class="token class-name">UITableView</span><span class="token punctuation">,</span> performDropWith coordinator<span class="token punctuation">:</span> <span class="token class-name">UITableViewDropCoordinator</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    code</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>At least in this initial beta, Xcode always inserts new method stubs at the top of your class, and if you&#39;re like me that will make your eye twitch – feel free to move them somewhere more sensible before continuing!</p><p>The <code>itemsForBeginning</code> method is easiest, so let&#39;s start there. It gets called when the user has initiated a drag operation on a table view cell by holding down their finger, and needs to return an array of drag items. If you return an <em>empty</em> array, you&#39;re effectively declining drag and drop.</p><p>We&#39;re going to give this method four lines of code:</p><ol><li>Figure out which string is being copied. We can do that with a simple ternary: if the table view in question is the left table view then read from <code>leftItems</code>, otherwise read from <code>rightItems</code>.</li><li>Attempt to convert the string to a <code>Data</code> object so it can be passed around using drag and drop.</li><li>Place that data inside an <code>NSItemProvider</code>, marking it as containing a plain text string so other apps know what to do with it.</li><li>Finally, place that item provider inside a <code>UIDragItem</code> so that it can be used for drag and drop by UIKit.</li></ol>`,12),P=n("code",null,"ViewController.swift",-1),F=t(`<div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token class-name">MobileCoreServices</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Now replace your <code>itemsForBeginning</code> method stub with this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">tableView</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> tableView<span class="token punctuation">:</span> <span class="token class-name">UITableView</span><span class="token punctuation">,</span> itemsForBeginning session<span class="token punctuation">:</span> <span class="token class-name">UIDragSession</span><span class="token punctuation">,</span> at indexPath<span class="token punctuation">:</span> <span class="token class-name">IndexPath</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">[</span><span class="token class-name">UIDragItem</span><span class="token punctuation">]</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> string <span class="token operator">=</span> tableView <span class="token operator">==</span> leftTableView <span class="token operator">?</span> leftItems<span class="token punctuation">[</span>indexPath<span class="token punctuation">.</span>row<span class="token punctuation">]</span> <span class="token punctuation">:</span> rightItems<span class="token punctuation">[</span>indexPath<span class="token punctuation">.</span>row<span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">guard</span> <span class="token keyword">let</span> data <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span>using<span class="token punctuation">:</span> <span class="token punctuation">.</span>utf8<span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">let</span> itemProvider <span class="token operator">=</span> <span class="token class-name">NSItemProvider</span><span class="token punctuation">(</span>item<span class="token punctuation">:</span> data <span class="token keyword">as</span> <span class="token class-name">NSData</span><span class="token punctuation">,</span> typeIdentifier<span class="token punctuation">:</span> <span class="token constant">kUTTypePlainText</span> <span class="token keyword">as</span> <span class="token class-name">String</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token class-name">UIDragItem</span><span class="token punctuation">(</span>itemProvider<span class="token punctuation">:</span> itemProvider<span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now we just need to fill in the <code>performDropWith</code> method. Well, I say &quot;just&quot;, but this is actually quite tricky because there are two potential complexities. First, we might be getting several strings at the same time if someone is dragging in lots of things, so we need to insert them all sensibly. Second, we might be told where the user wants to insert the rows, but we might not – they might just drag the strings onto some whitespace in the table, so we need to decide what that means for us.</p><p>To solve those two problems means writing more code than you may have expected, but I&#39;ll try to walk you through it step by step to make it a bit easier.</p><p>First, the easier part: figuring out where to drop rows. The <code>performDropWith</code> method passes us an object of the class <code>UITableViewDropCoordinator</code>, which has a <code>destinationIndexPath</code> property telling us where the user wants to drop the data. However, it&#39;s <em>optional</em>: it will be nil if they dragged their data over some empty cells in our table view, and if that happens we&#39;re going to assume they wanted to drop the data at the end of the table.</p><p>So, start by adding this code to the <code>performDropWith</code> method:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> destinationIndexPath<span class="token punctuation">:</span> <span class="token class-name">IndexPath</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> <span class="token keyword">let</span> indexPath <span class="token operator">=</span> coordinator<span class="token punctuation">.</span>destinationIndexPath <span class="token punctuation">{</span></span>
<span class="line">    destinationIndexPath <span class="token operator">=</span> indexPath</span>
<span class="line"><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> section <span class="token operator">=</span> tableView<span class="token punctuation">.</span>numberOfSections <span class="token operator">-</span> <span class="token number">1</span></span>
<span class="line">    <span class="token keyword">let</span> row <span class="token operator">=</span> tableView<span class="token punctuation">.</span><span class="token function">numberOfRows</span><span class="token punctuation">(</span>inSection<span class="token punctuation">:</span> section<span class="token punctuation">)</span></span>
<span class="line">    destinationIndexPath <span class="token operator">=</span> <span class="token class-name">IndexPath</span><span class="token punctuation">(</span>row<span class="token punctuation">:</span> row<span class="token punctuation">,</span> section<span class="token punctuation">:</span> section<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>As you can see, that either uses the coordinator&#39;s <code>destinationIndexPath</code> if it exists, or creates one by looking at the last row of the last section.</p><p>The next step is to ask the drop coordinator to load all the objects it has for a specific class, which in our case will be <code>NSString</code>. (No, regular <code>String</code> doesn&#39;t work.) We need to send this a closure of code to run when the items are ready, which is where the complexity starts: we need to insert them all one by one below the destination index path, modifying either the <code>leftItems</code> or <code>rightItems</code> arrays, before finally calling <code>insertRows()</code> on our table view to make them appear.</p><p>So, again: we&#39;ve just written code to figure out the destination index path for a drop operation. But if we get <em>multiple</em> items then all we have is the <code>initial</code> destination index path – the path for the first item. The <em>second</em> item should be one row lower, the third item should be two rows lower, and so on. As we move down each item to copy, we&#39;re going to create a new index path and stash it away in an <code>indexPaths</code> array so we can call <code>insertRows()</code> on our table view all at once.</p><p>Add this code to your <code>performDropWith</code> method, below the previous code we just wrote:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token comment">// attempt to load strings from the drop coordinator</span></span>
<span class="line">coordinator<span class="token punctuation">.</span>session<span class="token punctuation">.</span><span class="token function">loadObjects</span><span class="token punctuation">(</span>ofClass<span class="token punctuation">:</span> <span class="token class-name">NSString</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> items <span class="token keyword">in</span></span>
<span class="line">    <span class="token comment">// convert the item provider array to a string array or bail out</span></span>
<span class="line">    <span class="token keyword">guard</span> <span class="token keyword">let</span> strings <span class="token operator">=</span> items <span class="token keyword">as</span><span class="token operator">?</span> <span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// create an empty array to track rows we&#39;ve copied</span></span>
<span class="line">    <span class="token keyword">var</span> indexPaths <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">IndexPath</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// loop over all the strings we received</span></span>
<span class="line">    <span class="token keyword">for</span> <span class="token punctuation">(</span>index<span class="token punctuation">,</span> string<span class="token punctuation">)</span> <span class="token keyword">in</span> strings<span class="token punctuation">.</span><span class="token function">enumerated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// create an index path for this new row, moving it down depending on how many we&#39;ve already inserted</span></span>
<span class="line">        <span class="token keyword">let</span> indexPath <span class="token operator">=</span> <span class="token class-name">IndexPath</span><span class="token punctuation">(</span>row<span class="token punctuation">:</span> destinationIndexPath<span class="token punctuation">.</span>row <span class="token operator">+</span> index<span class="token punctuation">,</span> section<span class="token punctuation">:</span> destinationIndexPath<span class="token punctuation">.</span>section<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// insert the copy into the correct array</span></span>
<span class="line">        <span class="token keyword">if</span> tableView <span class="token operator">==</span> <span class="token keyword">self</span><span class="token punctuation">.</span>leftTableView <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">self</span><span class="token punctuation">.</span>leftItems<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>string<span class="token punctuation">,</span> at<span class="token punctuation">:</span> indexPath<span class="token punctuation">.</span>row<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">self</span><span class="token punctuation">.</span>rightItems<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>string<span class="token punctuation">,</span> at<span class="token punctuation">:</span> indexPath<span class="token punctuation">.</span>row<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// keep track of this new row</span></span>
<span class="line">        indexPaths<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>indexPath<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// insert them all into the table view at once</span></span>
<span class="line">    tableView<span class="token punctuation">.</span><span class="token function">insertRows</span><span class="token punctuation">(</span>at<span class="token punctuation">:</span> indexPaths<span class="token punctuation">,</span> with<span class="token punctuation">:</span> <span class="token punctuation">.</span>automatic<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That&#39;s all the code complete – you should be able to run the app now and drag rows between the two table views to copy them. It took quite a bit of work, yes, but I have a pleasant surprise for you: the work you&#39;ve done has enabled drag and drop across the entire system: if you try using the iPad simulator you&#39;ll find you can drag text from Apple News into either table view, or drag text from your table view into the URL bar in Safari, for example. Nice!</p><p>Before we&#39;re done with drag and drop, I want to demonstrate one more thing: how to add drag and drop support for other views. This is actually easier than using a table view, so let&#39;s whizz through it quickly.</p>`,15),T=n("code",null,"UIImageView",-1),A=n("code",null,"ViewController.swift",-1),j=t(`<div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token class-name">UIKit</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">ViewController</span><span class="token punctuation">:</span> <span class="token class-name">UIViewController</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// create a property for our image view and define its size</span></span>
<span class="line">    <span class="token keyword">var</span> imageView<span class="token punctuation">:</span> <span class="token class-name">UIImageView</span><span class="token operator">!</span></span>
<span class="line">    <span class="token keyword">let</span> size <span class="token operator">=</span> <span class="token number">512</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">override</span> <span class="token keyword">func</span> <span class="token function-definition function">viewDidLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">viewDidLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// create and add the image view</span></span>
<span class="line">        imageView <span class="token operator">=</span> <span class="token class-name">UIImageView</span><span class="token punctuation">(</span>frame<span class="token punctuation">:</span> <span class="token class-name">CGRect</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span> width<span class="token punctuation">:</span> size<span class="token punctuation">,</span> height<span class="token punctuation">:</span> size<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        view<span class="token punctuation">.</span><span class="token function">addSubview</span><span class="token punctuation">(</span>imageView<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// render a red circle at the same size, and use it in the image view</span></span>
<span class="line">        <span class="token keyword">let</span> renderer <span class="token operator">=</span> <span class="token class-name">UIGraphicsImageRenderer</span><span class="token punctuation">(</span>size<span class="token punctuation">:</span> <span class="token class-name">CGSize</span><span class="token punctuation">(</span>width<span class="token punctuation">:</span> size<span class="token punctuation">,</span> height<span class="token punctuation">:</span> size<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        imageView<span class="token punctuation">.</span>image <span class="token operator">=</span> renderer<span class="token punctuation">.</span>image <span class="token punctuation">{</span> ctx <span class="token keyword">in</span></span>
<span class="line">            <span class="token keyword">let</span> rectangle <span class="token operator">=</span> <span class="token class-name">CGRect</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">:</span> size<span class="token punctuation">,</span> height<span class="token punctuation">:</span> size<span class="token punctuation">)</span></span>
<span class="line">            ctx<span class="token punctuation">.</span>cgContext<span class="token punctuation">.</span><span class="token function">setFillColor</span><span class="token punctuation">(</span><span class="token class-name">UIColor</span><span class="token punctuation">.</span>red<span class="token punctuation">.</span>cgColor<span class="token punctuation">)</span></span>
<span class="line">            ctx<span class="token punctuation">.</span>cgContext<span class="token punctuation">.</span><span class="token function">fillEllipse</span><span class="token punctuation">(</span><span class="token keyword">in</span><span class="token punctuation">:</span> rectangle<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>As before, that is all old iOS code so I&#39;m not going to go into detail on it. If you try running that in the iPad simulator you should see a large red circle in your view controller – that&#39;s more than enough for us to test with.</p><p>Dragging for custom views is done using a new class called <code>UIDragInteraction</code>. You tell it where to send messages (in our case, we&#39;ll use the current view controller), then attach it to whatever view should be interactive.</p><div class="hint-container important"><p class="hint-container-title">Important</p><p>don&#39;t forget to enable user interaction on the view in question, otherwise you&#39;ll be scratching your head when things don&#39;t work.</p></div><p>First, add these three lines of code to the end of <code>viewDidLoad()</code>, just after the previous code. You&#39;ll see Xcode complaining that our view controller doesn&#39;t conform to the <code>UIDragInteractionDelegate</code> protocol, so please modify the class definition to this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">class</span> <span class="token class-name">ViewController</span><span class="token punctuation">:</span> <span class="token class-name">UIViewController</span><span class="token punctuation">,</span> <span class="token class-name">UIDragInteractionDelegate</span> <span class="token punctuation">{</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Xcode will complain because we don&#39;t actually implement the one required method of the <code>UIDragInteractionDelegate</code> protocol, so repeat what you did earlier – click the error marker on the bad line, then select &quot;Fix&quot; to insert this method stub:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">dragInteraction</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> interaction<span class="token punctuation">:</span> <span class="token class-name">UIDragInteraction</span><span class="token punctuation">,</span> itemsForBeginning session<span class="token punctuation">:</span> <span class="token class-name">UIDragSession</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">[</span><span class="token class-name">UIDragItem</span><span class="token punctuation">]</span> <span class="token punctuation">{</span></span>
<span class="line">    code</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This is just like the <code>itemsForBeginning</code> method we implemented for our table views earlier: we need to return whatever image we want to share when the user starts dragging on our image view.</p><p>The code for this is nice and simple: we&#39;ll pull out the image from the image view using <code>guard</code> to avoid problems, then wrap that first in a <code>NSItemProvider</code> then in a <code>UIDragItem</code> before sending it back.</p><p>Replace your <code>itemsForBeginning</code> stub with this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">dragInteraction</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> interaction<span class="token punctuation">:</span> <span class="token class-name">UIDragInteraction</span><span class="token punctuation">,</span> itemsForBeginning session<span class="token punctuation">:</span> <span class="token class-name">UIDragSession</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">[</span><span class="token class-name">UIDragItem</span><span class="token punctuation">]</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">guard</span> <span class="token keyword">let</span> image <span class="token operator">=</span> imageView<span class="token punctuation">.</span>image <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">let</span> provider <span class="token operator">=</span> <span class="token class-name">NSItemProvider</span><span class="token punctuation">(</span>object<span class="token punctuation">:</span> image<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">let</span> item <span class="token operator">=</span> <span class="token class-name">UIDragItem</span><span class="token punctuation">(</span>itemProvider<span class="token punctuation">:</span> provider<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token punctuation">[</span>item<span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>And that&#39;s it! Try using iPad multitasking to put the Photos app on the right of the screen – you should be able to drag the image from your app into Photos to have it copied across.</p><hr><h2 id="augmented-reality" tabindex="-1"><a class="header-anchor" href="#augmented-reality"><span>Augmented Reality</span></a></h2><p>Augmented reality (AR) has been around for a while, but with iOS 11 Apple has done something quite remarkable: they&#39;ve created an advanced implementation that integrates seamlessly with its existing game development technologies. This means you can take your existing SpriteKit or SceneKit skills and integrate them with AR without too much work, which is a tantalising prospect indeed.</p><p>Xcode comes with a great ARKit template right out of the box, so I encourage you to give it a try – you&#39;ll be surprised how easy it is!</p><p>I want to walk through the template just briefly so you can see how everything fits together. First, create a new Xcode project using the Augmented Reality App template, then select SpriteKit for Content Technology. Yes, SpriteKit is a 2D framework, but it still works great in ARKit because it billboards your sprites so they appear to twist and turn in 3D.</p>`,18),q=n("code",null,"Main.storyboard",-1),U=n("code",null,"ARSKView",-1),N=n("code",null,"ViewController.swift",-1),B=n("code",null,"viewWillAppear()",-1),R=n("code",null,"viewWillDisappear()",-1),L=n("em",null,"real",-1),W=n("code",null,"touchesBegan()",-1),O=n("code",null,"Scene.swift",-1),z=n("code",null,"nodeFor",-1),K=n("code",null,"ViewController.swift",-1),M=n("em",null,"anchors",-1),G=n("code",null,"nodeFor",-1),E=n("code",null,"MKMapView",-1),X=n("code",null,"Scene.swift",-1),Y=n("code",null,"touchesBegan()",-1),H=t(`<p>So, if the user is pointing ahead the anchor will be placed ahead, but if they are pointing up then the anchor will be placed above. And once the anchor is placed there, it stays there: ARKit will move, rotate and warp it automatically to ensure it stays aligned correctly as the player&#39;s device moves.</p><p>All that is done using these three lines of code:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">var</span> translation <span class="token operator">=</span> matrix_identity_float4x4</span>
<span class="line">translation<span class="token punctuation">.</span>columns<span class="token punctuation">.</span><span class="token number">3</span><span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">0.2</span></span>
<span class="line"><span class="token keyword">let</span> transform <span class="token operator">=</span> <span class="token function">simd_mul</span><span class="token punctuation">(</span>currentFrame<span class="token punctuation">.</span>camera<span class="token punctuation">.</span>transform<span class="token punctuation">,</span> translation<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Once the transform is calculated it gets converted into an anchor and added to the session like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> anchor <span class="token operator">=</span> <span class="token class-name">ARAnchor</span><span class="token punctuation">(</span>transform<span class="token punctuation">:</span> transform<span class="token punctuation">)</span></span>
<span class="line">sceneView<span class="token punctuation">.</span>session<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>anchor<span class="token punctuation">:</span> anchor<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div>`,5),Z=n("code",null,"nodeFor",-1),Q=n("code",null,"ViewController.swift",-1),J=n("code",null,"ARSKView",-1),$=n("em",null,"don't",-1),nn=t(`<p>As a result, the <code>nodeFor</code> method is simple:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">view</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> view<span class="token punctuation">:</span> <span class="token class-name">ARSKView</span><span class="token punctuation">,</span> nodeFor anchor<span class="token punctuation">:</span> <span class="token class-name">ARAnchor</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">SKNode</span><span class="token operator">?</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// Create and configure a node for the anchor added to the view&#39;s session.</span></span>
<span class="line">    <span class="token keyword">let</span> labelNode <span class="token operator">=</span> <span class="token class-name">SKLabelNode</span><span class="token punctuation">(</span>text<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Enemy&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    labelNode<span class="token punctuation">.</span>horizontalAlignmentMode <span class="token operator">=</span> <span class="token punctuation">.</span>center</span>
<span class="line">    labelNode<span class="token punctuation">.</span>verticalAlignmentMode <span class="token operator">=</span> <span class="token punctuation">.</span>center</span>
<span class="line">    <span class="token keyword">return</span> labelNode<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In case you were wondering, ARKit anchors have an <code>identifier</code> property that lets you know what kind of node to create. In the Xcode template all anchors are space aliens, but in your own projects you&#39;ll almost certainly want to identify things more uniquely.</p><p>And that&#39;s it! The end result is remarkably effective given how little code it takes – ARKit should prove to be a big hit.</p><hr><h2 id="pdf-rendering" tabindex="-1"><a class="header-anchor" href="#pdf-rendering"><span>PDF rendering</span></a></h2><p>macOS has always had first-rate support for rendering PDFs, and since OS X 10.4 has benefited from a framework called PDFKit that provides PDF rendering, manipulation, annotations, and more with hardly any code.</p><p>Well, as of iOS 11 that&#39;s available on iOS 11 in its entirety: you can use the <code>PDFView</code> class to display PDFs, let users move through a document, select and share content, zoom in and out, and more. Alternatively, you can use individual classes such as <code>PDFDocument</code>, <code>PDFPage</code>, and <code>PDFAnnotation</code> to create your own custom PDF reader.</p><p>As with drag and drop, we can create a simple container app to demonstrate just how easy PDFKit is. You can re-use the same Single View App project you made earlier if you want, but you do need to add a PDF to your project so PDFKit has something to read from.</p><p>To write this code you need to learn two new classes, both of which are trivial. The first is <code>PDFView</code>, which does all the hard work of rendering PDFs, responding to scroll and zoom gestures, selecting text, and so on. This is just a regular <code>UIView</code> subclass in iOS, so you can create it without any parameters then position it using Auto Layout to fit your needs. The second new class is <code>PDFDocument</code>, which loads a PDF from a URL ready to be rendered or manipulated elsewhere.</p>`,10),sn=n("code",null,"ViewController.swift",-1),an=t(`<div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token class-name">PDFKit</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token class-name">UIKit</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">ViewController</span><span class="token punctuation">:</span> <span class="token class-name">UIViewController</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// store our PDFView in a property so we can manipulate it later</span></span>
<span class="line">    <span class="token keyword">var</span> pdfView<span class="token punctuation">:</span> <span class="token class-name">PDFView</span><span class="token operator">!</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">override</span> <span class="token keyword">func</span> <span class="token function-definition function">viewDidLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">viewDidLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// create and add the PDF view</span></span>
<span class="line">        pdfView <span class="token operator">=</span> <span class="token class-name">PDFView</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        pdfView<span class="token punctuation">.</span>translatesAutoresizingMaskIntoConstraints <span class="token operator">=</span> <span class="token boolean">false</span></span>
<span class="line">        view<span class="token punctuation">.</span><span class="token function">addSubview</span><span class="token punctuation">(</span>pdfView<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// make it take up the full screen</span></span>
<span class="line">        pdfView<span class="token punctuation">.</span>leadingAnchor<span class="token punctuation">.</span><span class="token function">constraint</span><span class="token punctuation">(</span>equalTo<span class="token punctuation">:</span> view<span class="token punctuation">.</span>leadingAnchor<span class="token punctuation">)</span><span class="token punctuation">.</span>isActive <span class="token operator">=</span> <span class="token boolean">true</span></span>
<span class="line">        pdfView<span class="token punctuation">.</span>trailingAnchor<span class="token punctuation">.</span><span class="token function">constraint</span><span class="token punctuation">(</span>equalTo<span class="token punctuation">:</span> view<span class="token punctuation">.</span>trailingAnchor<span class="token punctuation">)</span><span class="token punctuation">.</span>isActive <span class="token operator">=</span> <span class="token boolean">true</span></span>
<span class="line">        pdfView<span class="token punctuation">.</span>topAnchor<span class="token punctuation">.</span><span class="token function">constraint</span><span class="token punctuation">(</span>equalTo<span class="token punctuation">:</span> view<span class="token punctuation">.</span>topAnchor<span class="token punctuation">)</span><span class="token punctuation">.</span>isActive <span class="token operator">=</span> <span class="token boolean">true</span></span>
<span class="line">        pdfView<span class="token punctuation">.</span>bottomAnchor<span class="token punctuation">.</span><span class="token function">constraint</span><span class="token punctuation">(</span>equalTo<span class="token punctuation">:</span> view<span class="token punctuation">.</span>bottomAnchor<span class="token punctuation">)</span><span class="token punctuation">.</span>isActive <span class="token operator">=</span> <span class="token boolean">true</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// load our example PDF and make it display immediately</span></span>
<span class="line">        <span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token class-name">Bundle</span><span class="token punctuation">.</span>main<span class="token punctuation">.</span><span class="token function">url</span><span class="token punctuation">(</span>forResource<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;your-pdf-name-here&quot;</span></span><span class="token punctuation">,</span> withExtension<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;pdf&quot;</span></span><span class="token punctuation">)</span><span class="token operator">!</span></span>
<span class="line">        pdfView<span class="token punctuation">.</span>document <span class="token operator">=</span> <span class="token class-name">PDFDocument</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> url<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>If you run the app you should already see you can scroll vertically through pages using a continuous scrolling mechanism. You can also pinch to zoom if you&#39;re testing on a real device – and you&#39;ll see the PDF re-render at higher resolution as you do. If you want to change the way the PDF is laid out, you can try manipulating the <code>displayMode</code>, <code>displayDirection</code>, and <code>displaysAsBook</code> properties.</p><p>For example, you can position the pages as double-page spreads with the cover by itself like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line">pdfView<span class="token punctuation">.</span>displayMode <span class="token operator">=</span> <span class="token punctuation">.</span>twoUpContinuous</span>
<span class="line">pdfView<span class="token punctuation">.</span>displaysAsBook <span class="token operator">=</span> <span class="token boolean">true</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>The <code>PDFView</code> class comes with a bunch of helpful methods to let users navigate and manipulate the PDF. To try this out, we&#39;re going to add some navigation bar buttons to our view controller, because that&#39;s the easiest way to add some interactivity.</p>`,5),en=n("code",null,"Main.storyboard",-1),tn=n("code",null,"viewDidLoad()",-1),on=n("code",null,"ViewController.swift",-1),pn=t(`<div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> printSelectionBtn <span class="token operator">=</span> <span class="token class-name">UIBarButtonItem</span><span class="token punctuation">(</span>title<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Selection&quot;</span></span><span class="token punctuation">,</span> style<span class="token punctuation">:</span> <span class="token punctuation">.</span>plain<span class="token punctuation">,</span> target<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">,</span> action<span class="token punctuation">:</span> <span class="token other-directive property">#selector</span><span class="token punctuation">(</span>printSelection<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">let</span> firstPageBtn <span class="token operator">=</span> <span class="token class-name">UIBarButtonItem</span><span class="token punctuation">(</span>title<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;First&quot;</span></span><span class="token punctuation">,</span> style<span class="token punctuation">:</span> <span class="token punctuation">.</span>plain<span class="token punctuation">,</span> target<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">,</span> action<span class="token punctuation">:</span> <span class="token other-directive property">#selector</span><span class="token punctuation">(</span>firstPage<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">let</span> lastPageBtn <span class="token operator">=</span> <span class="token class-name">UIBarButtonItem</span><span class="token punctuation">(</span>title<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Last&quot;</span></span><span class="token punctuation">,</span> style<span class="token punctuation">:</span> <span class="token punctuation">.</span>plain<span class="token punctuation">,</span> target<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">,</span> action<span class="token punctuation">:</span> <span class="token other-directive property">#selector</span><span class="token punctuation">(</span>lastPage<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">navigationItem<span class="token punctuation">.</span>rightBarButtonItems <span class="token operator">=</span> <span class="token punctuation">[</span>printSelectionBtn<span class="token punctuation">,</span> firstPageBtn<span class="token punctuation">,</span> lastPageBtn<span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That sets up three buttons to add some basic functionality. Finally, we just need to write the three methods being called by those buttons, so add these methods to the <code>ViewController</code> class:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">printSelection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">print</span><span class="token punctuation">(</span>pdfView<span class="token punctuation">.</span>currentSelection <span class="token operator">??</span> <span class="token string-literal"><span class="token string">&quot;No selection&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">func</span> <span class="token function-definition function">firstPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    pdfView<span class="token punctuation">.</span><span class="token function">goToFirstPage</span><span class="token punctuation">(</span><span class="token nil constant">nil</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">func</span> <span class="token function-definition function">lastPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    pdfView<span class="token punctuation">.</span><span class="token function">goToLastPage</span><span class="token punctuation">(</span><span class="token nil constant">nil</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now, if this were Swift 3 we would be done. But as of Swift 4 you&#39;ll start seeing the error &quot;Argument of &#39;#selector&#39; refers to instance method &#39;firstPage()&#39; that is not exposed to Objective-C&quot;, along with the proposed fix of &quot;Add &#39;@objc&#39; to expose this instance method to Objective-C&quot;. What this means is that the Swift method in question isn&#39;t visible to Objective-C, which matters because <code>UIBarButtonItem</code> is Objective-C code.</p><p>While adding <code>@objc</code> to individual methods is a working solution, I expect most people will just shrug their shoulders and put <code>@objcMembers</code> before their class – that automatically exposes everything in the class to Objective-C, just like Swift 3 used to. So, modify the class definition to this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@objcMembers</span></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">ViewController</span><span class="token punctuation">:</span> <span class="token class-name">UIViewController</span> <span class="token punctuation">{</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>That should compile correctly now, and you&#39;ll see the first and last pages work straight away. As for the selection button, you just need to select some text in the PDF before clicking it - this works just like text selection in iBooks.</p><hr><h2 id="nfc-reading-now-available" tabindex="-1"><a class="header-anchor" href="#nfc-reading-now-available"><span>NFC reading now available</span></a></h2><p>The iPhone 7 introduced hardware support for NFC, and as of iOS 11 that&#39;s available for all of us to use in our apps: you can now write code to detect nearby NFC NDEF tags, and it&#39;s surprisingly easy. To try it out, create a new iOS project using the Single View App template in Xcode, then head to the Capabilities tab in your project settings and enable Near Field Communication Tag Reading.</p><p>When using NFC, you also need to provide an explanation for the user so they know what&#39;s going on. To do that, open your Info.plist file, then right-click in the white space and choose &quot;Add Row&quot;. Give it the key name &quot;Privacy - NFC Scan Usage Description&quot; and the value &quot;SwiftyNFC&quot;.</p><p>To perform the actual scanning you need to create a property to store a <code>NFCNDEFReaderSession</code> object, which represents the current NFC scanning session, then create it and ask it to begin scanning.</p><p>When you create the reader session, you need to give it three pieces of data: the delegate it can send messages to, the queue it should use to send those messages, and whether it should stop scanning as soon as it finds an NFC tag. We&#39;re going to use <code>self</code> for the delegate, <code>DispatchQueue.main</code> for the queue, and false to stop scanning after it finds a tag, so it continues scanning until its 60-second time out is reached.</p>`,13),ln=n("code",null,"ViewController.swift",-1),cn=n("code",null,"CoreNFC",-1),rn=n("code",null,"ViewController",-1),un=t(`<div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">var</span> session<span class="token punctuation">:</span> <span class="token class-name">NFCNDEFReaderSession</span><span class="token operator">!</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Next, add these two lines of code to <code>viewDidLoad()</code>:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line">session <span class="token operator">=</span> <span class="token class-name">NFCNDEFReaderSession</span><span class="token punctuation">(</span>delegate<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">,</span> queue<span class="token punctuation">:</span> <span class="token class-name">DispatchQueue</span><span class="token punctuation">.</span>main<span class="token punctuation">,</span> invalidateAfterFirstRead<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">)</span></span>
<span class="line">session<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>The <code>ViewController</code> class doesn&#39;t currently conform to the <code>NFCNDEFReaderSessionDelegate</code> protocol, so you&#39;ll need to amend your class definition to include it:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">class</span> <span class="token class-name">ViewController</span><span class="token punctuation">:</span> <span class="token class-name">UIViewController</span><span class="token punctuation">,</span> <span class="token class-name">NFCNDEFReaderSessionDelegate</span> <span class="token punctuation">{</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>As per usual, Xcode will complain that you&#39;re missing some required methods, so use its recommended fix to insert these two method stubs:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">readerSession</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> session<span class="token punctuation">:</span> <span class="token class-name">NFCNDEFReaderSession</span><span class="token punctuation">,</span> didDetectNDEFs messages<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">NFCNDEFMessage</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    code</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">func</span> <span class="token function-definition function">readerSession</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> session<span class="token punctuation">:</span> <span class="token class-name">NFCNDEFReaderSession</span><span class="token punctuation">,</span> didInvalidateWithError error<span class="token punctuation">:</span> <span class="token class-name">Error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    code</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Both of those methods are easy enough, but error handling is particularly so – we&#39;re just going to make the error print out to the Xcode console. Fill in the <code>didInvalidateWithError</code> method like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">readerSession</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> session<span class="token punctuation">:</span> <span class="token class-name">NFCNDEFReaderSession</span><span class="token punctuation">,</span> didInvalidateWithError error<span class="token punctuation">:</span> <span class="token class-name">Error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">print</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>localizedDescription<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now for the <code>didDetectNDEFs</code> method. When this is called you&#39;ll get an array of detected messages, each of which can contain one or more records describing a single piece of data. For example, you might have seen NFC used to launch the Google Cardboard app: Cardboard devices have a simple NFC tag containing the absolute URL &quot;cardboard://V1.0.0&quot;, which gets detected by devices and causes the app to be shown.</p><p>What you do with the NFC data is down to you, so we&#39;re just going to print it out. Modify your <code>didDetectNDEFs</code> method to this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">readerSession</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> session<span class="token punctuation">:</span> <span class="token class-name">NFCNDEFReaderSession</span><span class="token punctuation">,</span> didDetectNDEFs messages<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">NFCNDEFMessage</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">for</span> message <span class="token keyword">in</span> messages <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">for</span> record <span class="token keyword">in</span> message<span class="token punctuation">.</span>records <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">if</span> <span class="token keyword">let</span> string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> record<span class="token punctuation">.</span>payload<span class="token punctuation">,</span> encoding<span class="token punctuation">:</span> <span class="token punctuation">.</span>ascii<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token function">print</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That&#39;s all the code complete, so go ahead and run the app! If everything has worked, you will immediately see some system user interface appear prompting the user to hold their device near something to scan. As you can see, it&#39;s just not possible for nefarious apps to abuse NFC scanning – not only do we have no control over the user interface, but it also times out after 60 seconds to avoid wasting battery.</p><hr><h2 id="machine-learning-and-vision" tabindex="-1"><a class="header-anchor" href="#machine-learning-and-vision"><span>Machine learning and Vision</span></a></h2><p>Machine Learning is the <em>buzzword du jour</em>, and lets computers adapt to new data based on processing rules they have been exposed to in the past. For example, &quot;does this picture contain a guitar?&quot; is a difficult question to answer if you just have a picture of a guitar and an empty Swift file, but if you build a trained model out of many sample input images of a guitar then you can effectively train computers to detect new images of guitars.</p><p>This might sound dull, but it&#39;s actually the basis of a number of huge technologies in iOS 11: Siri, Camera, and Quick Type all use it to help gain a better understanding of the world you&#39;re using them in. iOS 11 also introduces a new Vision framework, which is a slightly nebulous combination of things from Core Image, machine learning functionality, and all new technology.</p><p>In iOS 11 this is all provided by a new machine learning framework called Core ML, which is designed to support a wide variety of models rather than just examining images. Believe it or not, Core ML is almost trivial to write code for, however, that&#39;s only one part of the story.</p><p>You see, Core ML requires trained models to work with: the result of training an algorithm on a variety of data. These models can range from a few kilobytes to hundreds of megabytes or more, and obviously require a certain amount of expertise to produce – particularly if you&#39;re working with image recognition. Fortunately, Apple has provided a handful of models we can use to get up and running quickly, so if you just want to take Core ML for a test ride it&#39;s actually easy.</p><p>Sadly, even that is only another part of the story: there&#39;s a third part, which is thoroughly evil. You see, Core ML models automatically generate code for us that accept some input data and return some output – that part is beautiful. Sadly, the input data they want when processing images isn&#39;t a <code>UIImage</code>, nor is it a <code>CGImage</code>, or even a <code>CIImage</code>.</p>`,20),dn=n("code",null,"CVPixelBuffer",-1),kn=n("code",null,"UIImage",-1),hn=n("code",null,"CVPixelBuffer",-1),mn={href:"https://x.com/cieslak",target:"_blank",rel:"noopener noreferrer"},wn={href:"http://www.wtfpl.net/about/",target:"_blank",rel:"noopener noreferrer"},vn=n("p",null,[s("Let's try out Core ML now. Create a new Single View App project (or re-use your existing one), then add a picture of something – I added a picture of "),n("img",{src:"https://upload.wikimedia.org/wikipedia/commons/9/92/Washington_Dulles_International_Airport_at_Dusk.jpg",alt:'<FontIcon icon="fa-brands fa-wikipedia-w"/>Washington Dulles International Airport',loading:"lazy"}),s(' from Wikipedia. Name the picture "test.jpg" in your project to avoid typos.')],-1),gn={href:"https://developer.apple.com/machine-learning/",target:"_blank",rel:"noopener noreferrer"},fn=n("p",null,`Once you've downloaded the model, drag it into your Xcode project then select it so you can see Core ML's model viewer. You'll see it's a neural network classifier produced out of MIT, and available under a Creative Commons license. Below that you'll see it has "sceneImage" for its inputs, and "sceneLabelProbs" and "sceneLabel" for its output – an image for input, and some text describing what it thinks of the image for output.`,-1),bn=n("p",null,`You'll also see "Model class" and "Swift generated source" – Xcode generates a class for us that wraps up the entire thing in only a few lines of code, which is quite remarkable as you'll see shortly.`,-1),yn=n("p",null,"At this point we have an image to recognize and a trained model that can examine it. All we need to do now is put the two together: load the image, prepare it for the model, then ask the model for its prediction.",-1),In=n("code",null,"ViewController.swift",-1),xn=t(`<div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token class-name">UIKit</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">ViewController</span><span class="token punctuation">:</span> <span class="token class-name">UIViewController</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">override</span> <span class="token keyword">func</span> <span class="token function-definition function">viewDidLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">viewDidLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">let</span> image <span class="token operator">=</span> <span class="token class-name">UIImage</span><span class="token punctuation">(</span>named<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;test.jpg&quot;</span></span><span class="token punctuation">)</span><span class="token operator">!</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// 1</span></span>
<span class="line">        <span class="token comment">// 2</span></span>
<span class="line">        <span class="token comment">// 3</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That just loads our test image, ready for processing. The next steps are to fill in those three comments, one by one, starting with <code>// 1</code>.</p><p>Image-based Core ML models expect to receive images at a precise size, which is whatever size they were trained with. In the case of the GoogLeNetPlaces model that&#39;s 224x224, but other models have different sizes and Core ML will tell you if you send something at the wrong resolution.</p><p>So, the first thing we need to is scale down our image so that it&#39;s precisely 224x224, disregarding whether we&#39;re using a retina device or otherwise. This can be done using <code>UIGraphicsBeginImageContextWithOptions()</code>, forcing a scale of 1.0. Replace the <code>// 1</code> comment with this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> modelSize <span class="token operator">=</span> <span class="token number">224</span></span>
<span class="line"><span class="token class-name">UIGraphicsBeginImageContextWithOptions</span><span class="token punctuation">(</span><span class="token class-name">CGSize</span><span class="token punctuation">(</span>width<span class="token punctuation">:</span> modelSize<span class="token punctuation">,</span> height<span class="token punctuation">:</span> modelSize<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span></span>
<span class="line">image<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token class-name">CGRect</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">:</span> modelSize<span class="token punctuation">,</span> height<span class="token punctuation">:</span> modelSize<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">let</span> newImage <span class="token operator">=</span> <span class="token class-name">UIGraphicsGetImageFromCurrentImageContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span></span>
<span class="line"><span class="token class-name">UIGraphicsEndImageContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That gives us a new constant called <code>newImage</code>, which is a <code>UIImage</code> at the correct size for our model.</p><p>Now for the second part, which is the truly vicious conversion between <code>UIImage</code> and <code>CVPixelBuffer</code>. This is pointlessly complicated, so I&#39;m not even going to bother trying to explain all the various steps and I don&#39;t recommend you do anything more than copy and paste this code. Replace the <code>// 2</code> comment with this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> attrs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token constant">kCVPixelBufferCGImageCompatibilityKey</span><span class="token punctuation">:</span> <span class="token constant">kCFBooleanTrue</span><span class="token punctuation">,</span> <span class="token constant">kCVPixelBufferCGBitmapContextCompatibilityKey</span><span class="token punctuation">:</span> <span class="token constant">kCFBooleanTrue</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token class-name">CFDictionary</span></span>
<span class="line"><span class="token keyword">var</span> pixelBuffer <span class="token punctuation">:</span> <span class="token class-name">CVPixelBuffer</span><span class="token operator">?</span></span>
<span class="line"><span class="token keyword">let</span> status <span class="token operator">=</span> <span class="token class-name">CVPixelBufferCreate</span><span class="token punctuation">(</span><span class="token constant">kCFAllocatorDefault</span><span class="token punctuation">,</span> <span class="token class-name">Int</span><span class="token punctuation">(</span>newImage<span class="token punctuation">.</span>size<span class="token punctuation">.</span>width<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Int</span><span class="token punctuation">(</span>newImage<span class="token punctuation">.</span>size<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">,</span> kCVPixelFormatType_32ARGB<span class="token punctuation">,</span> attrs<span class="token punctuation">,</span> <span class="token operator">&amp;</span>pixelBuffer<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">guard</span> <span class="token punctuation">(</span>status <span class="token operator">==</span> <span class="token constant">kCVReturnSuccess</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token class-name">CVPixelBufferLockBaseAddress</span><span class="token punctuation">(</span>pixelBuffer<span class="token operator">!</span><span class="token punctuation">,</span> <span class="token class-name">CVPixelBufferLockFlags</span><span class="token punctuation">(</span>rawValue<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">let</span> pixelData <span class="token operator">=</span> <span class="token class-name">CVPixelBufferGetBaseAddress</span><span class="token punctuation">(</span>pixelBuffer<span class="token operator">!</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">let</span> rgbColorSpace <span class="token operator">=</span> <span class="token class-name">CGColorSpaceCreateDeviceRGB</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">let</span> context <span class="token operator">=</span> <span class="token class-name">CGContext</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> pixelData<span class="token punctuation">,</span> width<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">(</span>newImage<span class="token punctuation">.</span>size<span class="token punctuation">.</span>width<span class="token punctuation">)</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">(</span>newImage<span class="token punctuation">.</span>size<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">,</span> bitsPerComponent<span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span> bytesPerRow<span class="token punctuation">:</span> <span class="token class-name">CVPixelBufferGetBytesPerRow</span><span class="token punctuation">(</span>pixelBuffer<span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">,</span> space<span class="token punctuation">:</span> rgbColorSpace<span class="token punctuation">,</span> bitmapInfo<span class="token punctuation">:</span> <span class="token class-name">CGImageAlphaInfo</span><span class="token punctuation">.</span>noneSkipFirst<span class="token punctuation">.</span>rawValue<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">context<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">translateBy</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> newImage<span class="token punctuation">.</span>size<span class="token punctuation">.</span>height<span class="token punctuation">)</span></span>
<span class="line">context<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">scaleBy</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token class-name">UIGraphicsPushContext</span><span class="token punctuation">(</span>context<span class="token operator">!</span><span class="token punctuation">)</span></span>
<span class="line">newImage<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token class-name">CGRect</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">:</span> newImage<span class="token punctuation">.</span>size<span class="token punctuation">.</span>width<span class="token punctuation">,</span> height<span class="token punctuation">:</span> newImage<span class="token punctuation">.</span>size<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token class-name">UIGraphicsPopContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token class-name">CVPixelBufferUnlockBaseAddress</span><span class="token punctuation">(</span>pixelBuffer<span class="token operator">!</span><span class="token punctuation">,</span> <span class="token class-name">CVPixelBufferLockFlags</span><span class="token punctuation">(</span>rawValue<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You might want to wrap all that gibberish in a helper function if you intend to use it a lot, but whatever you do please don&#39;t bother trying to memorize it.</p><p>Now for the important, interesting, and trivial part: actually using Core ML. This is just three lines of code, which is, quite frankly, criminally easy. Like I said, Xcode automatically generates a Swift class from the Core ML model, so we can instantiate that immediately as <code>GoogLeNetPlaces</code>.</p><p>We can then pass our pixel buffer into its <code>prediction()</code> method, which will either return a prediction or throw an error. In practice, you&#39;ll probably find it easier to use <code>try?</code> to either get a value back or nil. Finally, we&#39;ll just print out the prediction so you can see how Core ML fared.</p><p>Replace the <code>// 3</code> comment with this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> model <span class="token operator">=</span> <span class="token class-name">GoogLeNetPlaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">guard</span> <span class="token keyword">let</span> prediction <span class="token operator">=</span> <span class="token keyword">try</span><span class="token operator">?</span> model<span class="token punctuation">.</span><span class="token function">prediction</span><span class="token punctuation">(</span>sceneImage<span class="token punctuation">:</span> pixelBuffer<span class="token operator">!</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">}</span></span>
<span class="line"><span class="token function">print</span><span class="token punctuation">(</span>prediction<span class="token punctuation">.</span>sceneLabel<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Believe it or not, that really is all it takes to use Core ML in code; all the rest was setup for those three simple lines. What you get printed out depends on what you put in and your model, but GoogLeNetPlaces correctly identified my image as an airport terminal, and did so entirely on device – there was no need to send the image off to a server to be processed, so you get great privacy out of the box.</p><hr><h2 id="lots-of-other-improvements" tabindex="-1"><a class="header-anchor" href="#lots-of-other-improvements"><span>Lots of other improvements…</span></a></h2><p>There are lots of other improvements across iOS 11 – here are my favorites:</p><ul><li>Metal 2 is set to increase graphics performance across the system. I haven&#39;t provided code examples here because it&#39;s quite a specialist topic – most people will just be happy to see their SpriteKit, SceneKit, and Unity apps get faster for no extra work.</li><li>Table view cells are now automatically self-sizing. Previously this behavior was triggered using <code>UITableViewAutomaticDimension</code> for a row height, but it&#39;s no longer needed.</li><li>Table views also gained a new closure-based <code>performBatchUpdates()</code> method, which lets you animate mutiple inserts, deletes, and moves at once – and even runs a completion closure once the animations are finished.</li><li>The new heavy black titles first seen in Apple Music have now spread across the system, and are available to our own apps with one small change: check &quot;Prefers Large Titles&quot; for your navigation bar in IB, or use <code>navigationController?.navigationBar.prefersLargeTitles = true</code> if you prefer to do it in code.</li><li>The <code>topLayoutGuide</code> property has been deprecated in favor of <code>safeAreaLayoutGuide</code>. This provides edges for all sides rather than just top and bottom, but may well forebode future iPhones with non-rectangular layouts – full-screen iPhone 8 with embedded camera, anyone?</li><li>Stack views have gained a <code>setCustomSpacing(_:after:)</code> method, which lets you add gaps in the stack view wherever you want rather than uniformly.</li></ul><hr><h2 id="and-then-there-s-xcode" tabindex="-1"><a class="header-anchor" href="#and-then-there-s-xcode"><span>And then there&#39;s Xcode</span></a></h2><p>Xcode 9 is the most exciting Xcode release I&#39;ve ever seen - it&#39;s packed full of incredible new features that will make even the most hardened Xcode complainer reconsider.</p><p>Here are the big features that caught my eye:</p><ul><li>Refactoring for Swift and Objective-C is built right into the editor, which means you can make sweeping changes to your code (e.g renaming a method) in just a few clicks.</li><li>Wireless debugging is now available for iOS and tvOS. To enable this functionality, connect your device using USB then go to the Window menu and choose Devices and Simulators. Select your device, then check the &quot;Connect via network&quot; option. Don&#39;t be surprised if it doesn&#39;t work first time – it&#39;s only beta 1!</li><li>The source editor has been rewritten in Swift, which has resulted in extraordinary speed improvements for scrolling and searching, along with helpful features such as scope highlighting when you hold down the Ctrl key.</li><li>You can now add named colors to asset catalogs, which lets you define them once and use them everywhere with the new <code>UIColor(named:)</code> initializer.</li><li>There&#39;s a new main thread checker enabled by default, which will automatically warn you when it detects any UIKit method calls that aren&#39;t made on the main thread – a common source of bugs.</li><li>You can now run multiple simulators concurrently, and you can even resize them freely. Apple added extra user interface around the simulators to give us access to hardware controls.</li><li>If you&#39;re not keen to use Swift 4 immediately, there&#39;s a new &quot;Swift Language Version&quot; build setting that lets you choose either Swift 4.0 or Swift 3.2. Both use the same compiler, but enable different options internally.</li></ul><p>Seriously, I wish I were at WWDC this year just so I could hug the Xcode engineers – this is a scorching release that sets Xcode up for continued greatness.</p>`,24);function _n(u,Cn){const p=r("VPCard"),o=r("router-link"),e=r("FontIcon");return m(),k("div",null,[n("h1",v,[n("a",g,[n("span",null,h(u.$frontmatter.title)+" 관련",1)])]),a(p,l(c({title:"Swift > Article(s)",desc:"Article(s)",link:"/programming/swift/articles/README.md",logo:"/images/ico-wind.svg",background:"rgba(10,10,10,0.2)"})),null,16),n("nav",f,[n("ul",null,[n("li",null,[a(o,{to:"#drag-and-drop"},{default:i(()=>[s("Drag and drop")]),_:1})]),n("li",null,[a(o,{to:"#augmented-reality"},{default:i(()=>[s("Augmented Reality")]),_:1})]),n("li",null,[a(o,{to:"#pdf-rendering"},{default:i(()=>[s("PDF rendering")]),_:1})]),n("li",null,[a(o,{to:"#nfc-reading-now-available"},{default:i(()=>[s("NFC reading now available")]),_:1})]),n("li",null,[a(o,{to:"#machine-learning-and-vision"},{default:i(()=>[s("Machine learning and Vision")]),_:1})]),n("li",null,[a(o,{to:"#lots-of-other-improvements"},{default:i(()=>[s("Lots of other improvements…")]),_:1})]),n("li",null,[a(o,{to:"#and-then-there-s-xcode"},{default:i(()=>[s("And then there's Xcode")]),_:1})])])]),b,a(p,l(c({title:"What's new in iOS 11 for developers – Hacking with Swift",desc:"What's new in iOS 11 for developers",link:"https://hackingwithswift.com/whats-new-in-ios-11",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),y,I,x,a(p,l(c({title:"What's new in Swift 4.0 – Hacking with Swift",desc:"Hands-on code examples to help you learn what's new in Swift 4: new encoding and decoding, smarter keypaths, multi-line strings, and more!",link:"/hackingwithswift.com/swift4.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),a(p,l(c({title:"What's new in Swift 3.1 – Hacking with Swift",desc:"What's new in Swift 3.1",link:"/hackingwithswift.com/swift3-1.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),a(p,l(c({title:"What's new in iOS 10 for developers – Hacking with Swift",desc:"What's new in iOS 10 for developers",link:"/hackingwithswift.com/ios10.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),a(p,l(c({title:"What's new in iOS 9 for developers – Hacking with Swift",desc:"What's new in iOS 9 for developers",link:"/hackingwithswift.com/ios9.md",logo:"https://hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),_,n("p",null,[s("Create a new Single View App template in Xcode, then open "),a(e,{icon:"fa-brands fa-swift"}),C,s(" for editing.")]),S,n("p",null,[s("Again, this is all code from before iOS 11, so it should be nothing new to you. Replace the content of "),a(e,{icon:"fa-brands fa-swift"}),V,s(" with this:")]),D,n("p",null,[s("To mark the item data as being plain text we need to import the MobileCoreServices framework, so please add this line of code near the top of "),a(e,{icon:"fa-brands fa-swift"}),P,s(":")]),F,n("p",null,[s("As before, we need a simple harness so we have something we can add drag and drop to. This time we're going to create a "),T,s(" and render a simple red circle for its image. You can keep your existing Single View App template and just replace "),a(e,{icon:"fa-brands fa-swift"}),A,s(" with this new code:")]),j,n("p",null,[s("If you open "),a(e,{icon:"iconfont icon-xcode"}),q,s(", you'll see that the ARKit template works a little differently from the regular SpriteKit template: it uses a new "),U,s(" Interface Builder object, which is what brings together the two worlds of ARKit and SpriteKit. That's connected to an outlet in "),a(e,{icon:"fa-brands fa-swift"}),N,s(", which sets up the AR tracking in "),B,s(" and pauses it in "),R,s(".")]),n("p",null,[s("However, the "),L,s(" work takes place in two other places: the "),W,s(" method of "),a(e,{icon:"fa-brands fa-swift"}),O,s(", and the "),z,s(" method in "),a(e,{icon:"fa-brands fa-swift"}),K,s(". In regular SpriteKit you create nodes and add them to your scene directly, but with ARKit you create "),M,s(" – placeholders that have a position in the scene and an identifier, but no actual content. These then get converted into SpriteKit nodes as needed using the "),G,s(" method. If you've ever used "),E,s(", this is similar to the way annotations and pins work – annotations are your model data, and pins are the views.")]),n("p",null,[s("Inside "),a(e,{icon:"fa-brands fa-swift"}),X,s("'s "),Y,s(" method you'll see code to pull out the current frame from ARKit, then calculate where to place a new enemy. This is done using matrix multiplication: if you create an identity matrix (something representing the position X:0, Y:0, Z:0) then move its Z coordinate back by 0.2 (equivalent to 0.2 meters), you can multiply that by the current scene's camera to move back in the direction the user is pointing.")]),H,n("p",null,[s("Finally, the "),Z,s(" method in "),a(e,{icon:"fa-brands fa-swift"}),Q,s(" will get called. This happens because that view controller was configured to be the delegate of the "),J,s(", so it's responsible for converting anchors into nodes as needed. You "),$,s(" need to worry about positioning these nodes: remember, anchors are already being placed at precise coordinates in real-world space, and ARKit is responsible for mapping its position and transform to your SpriteKit nodes.")]),nn,n("p",null,[s("Replace all the code in "),a(e,{icon:"fa-brands fa-swift"}),sn,s(" with this:")]),an,n("p",null,[s("This takes three steps, starting with adding a navigation controller so we have an actual navigation bar to work with. So, open "),a(e,{icon:"iconfont icon-xcode"}),en,s(", select View Controller Scene in the document outline, then go to the Editor menu and choose Embed In > Navigation Controller.")]),n("p",null,[s("Next, add this code to "),tn,s(" in "),a(e,{icon:"fa-brands fa-swift"}),on]),pn,n("p",null,[s("Open "),a(e,{icon:"fa-brands fa-swift"}),ln,s(", add an import for "),cn,s(", then add this property to the "),rn,s(" class:")]),un,n("p",null,[s("Instead, Apple has chosen to make us use "),dn,s(", which is about as welcome in my code as a porcupine in a hemophiliac meetup. There is no nice, efficient way of converting a "),kn,s(" to a "),hn,s(", and I feel confident saying that because I wasted several hours trying to make one. Fortunately for me "),n("a",mn,[a(e,{icon:"fa-brands fa-x-twitter"}),s("Chris Cieslak")]),s(" was kind enough to share his code with me, and he's made it available under the "),n("a",wn,[a(e,{icon:"fas fa-globe"}),s("WTFPL")]),s(" so you can use it too.")]),vn,n("p",null,[s("Now that we have some test input, we need to add a trained model. It might not have seen our exact picture before, but it needs to have been exposed to similar pictures in order to have a shot at recognizing the airport. Apple provides a selection of pre-configured models at "),n("a",gn,[a(e,{icon:"fa-brands fa-apple"}),s("https://developer.apple.com/machine-learning")]),s(` – please go there now, and download the model for "Places205-GoogLeNet". This is only 25MB, so it won't take up much space on your user's devices.`)]),fn,bn,yn,n("p",null,[s("To help make this code easier to understand, I've split it into a number of chunks. To begin with, open "),a(e,{icon:"fa-brands fa-swift"}),In,s(" and modify it to this:")]),xn])}const Dn=d(w,[["render",_n],["__file","whats-new-in-ios-11.html.vue"]]),Pn=JSON.parse(`{"path":"/hackingwithswift.com/whats-new-in-ios-11.html","title":"What's new in iOS 11 for developers","lang":"ko-KR","frontmatter":{"lang":"ko-KR","title":"What's new in iOS 11 for developers","description":"What's new in iOS 11 for developers","icon":"fa-brands fa-swift","category":["Swift","Article(s)"],"tag":["blog","hackingwithswift.com","crashcourse","swift","ios","ios-11","xcode"],"head":[[{"meta":null},{"property":"og:title","content":"What's new in iOS 11 for developers"},{"property":"og:description","content":"What's new in iOS 11 for developers"},{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/hackingwithswift.com/whats-new-in-ios-11.html"}],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/hackingwithswift.com/whats-new-in-ios-11.html"}],["meta",{"property":"og:site_name","content":"📚Bookshelf"}],["meta",{"property":"og:title","content":"What's new in iOS 11 for developers"}],["meta",{"property":"og:description","content":"What's new in iOS 11 for developers"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://upload.wikimedia.org/wikipedia/commons/9/92/Washington_Dulles_International_Airport_at_Dusk.jpg"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"property":"article:tag","content":"blog"}],["meta",{"property":"article:tag","content":"hackingwithswift.com"}],["meta",{"property":"article:tag","content":"crashcourse"}],["meta",{"property":"article:tag","content":"swift"}],["meta",{"property":"article:tag","content":"ios"}],["meta",{"property":"article:tag","content":"ios-11"}],["meta",{"property":"article:tag","content":"xcode"}],["meta",{"property":"article:published_time","content":"2016-06-20T00:00:00.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"What's new in iOS 11 for developers\\",\\"image\\":[\\"https://upload.wikimedia.org/wikipedia/commons/9/92/Washington_Dulles_International_Airport_at_Dusk.jpg\\"],\\"datePublished\\":\\"2016-06-20T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[]}"]],"prev":"/programming/swift/articles/README.md","date":"2016-06-20T00:00:00.000Z","isOriginal":false},"headers":[{"level":2,"title":"Drag and drop","slug":"drag-and-drop","link":"#drag-and-drop","children":[]},{"level":2,"title":"Augmented Reality","slug":"augmented-reality","link":"#augmented-reality","children":[]},{"level":2,"title":"PDF rendering","slug":"pdf-rendering","link":"#pdf-rendering","children":[]},{"level":2,"title":"NFC reading now available","slug":"nfc-reading-now-available","link":"#nfc-reading-now-available","children":[]},{"level":2,"title":"Machine learning and Vision","slug":"machine-learning-and-vision","link":"#machine-learning-and-vision","children":[]},{"level":2,"title":"Lots of other improvements…","slug":"lots-of-other-improvements","link":"#lots-of-other-improvements","children":[]},{"level":2,"title":"And then there's Xcode","slug":"and-then-there-s-xcode","link":"#and-then-there-s-xcode","children":[]}],"git":{"contributors":[{"name":"chanhi2000","email":"chanhi2000@gmail.com","commits":2}]},"readingTime":{"minutes":22.65,"words":6794},"filePathRelative":"hackingwithswift.com/whats-new-in-ios-11.md","localizedDate":"2016년 6월 20일","excerpt":"\\n"}`);export{Dn as comp,Pn as data};
